
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>API &#8212; dro 0.1.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/basic_mod.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <script src="../_static/js/petite-vue.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Personal Loss" href="../tutorials/personal_loss.html" /> 
  </head><body data-dark_mode_code_blocks="true">

<div id="top_nav">
    
        <div id="notification_banner" data-banner-hiding="permanent" v-show="!permanentlyHidden">
    <p v-if="visible" id="content">A GIFT to the whole DRO community!</p>
    <a class="close" href="#" @click.prevent="toggleVisible()">[[ visible ? '&#x25B2; HIDE' : '&#x25BC; SHOW BANNER' ]]</a>
</div>

<script>
(function() {
    const topNav = document.querySelector('#top_nav')
    const notificationContent = document.querySelector('#notification_banner p#content').innerText
    const localStorageKey = 'readNotification'
    const bannerHiding = document.querySelector('#notification_banner').dataset['bannerHiding']
    const cssVariableName = '--navbarHeight'
    const rootElement = document.documentElement

    /*************************************************************************/
    // Local storage for remembering if the user has read the notification.

    function checkAlreadyRead() {
        return localStorage.getItem(localStorageKey) == notificationContent
    }

    function setRead() {
        localStorage.setItem(localStorageKey, notificationContent)
    }

    function clearRead() {
        localStorage.removeItem(localStorageKey)
    }

    const alreadyRead = checkAlreadyRead()
    const permanentlyHidden = alreadyRead && bannerHiding == 'permanent'

    /*************************************************************************/
    // Updating a CSS variable so other elements adjust to the nav bar height.

    function updateNavbarHeight() {
        // Only update it if the delta is significant. Otherwise it causes
        // unnecessary browser repaints.
        const documentStyles = getComputedStyle(rootElement)
        // We store the value in REM, so need to convert to pixels
        const currentValue = parseFloat(
            documentStyles.getPropertyValue(cssVariableName)
        ) * parseFloat(documentStyles.fontSize)

        const newValue = topNav.clientHeight

        if (newValue - 5 > currentValue) {
            console.log(`Updating ${cssVariableName} - overlapping`)
            rootElement.style.setProperty(
                cssVariableName, newValue + "px"
            );
        } else if (currentValue - newValue >= 30) {
            console.log(`Updating ${cssVariableName} - gap too large`)
            rootElement.style.setProperty(
                cssVariableName, newValue + "px"
            );
        }
    }

    /*************************************************************************/
    // After loading the page, and resizing the window, recalculate the nav bar
    // height.

    if (!permanentlyHidden) {
        // This height is approximately correct when there's a banner, so
        // shouldn't require any page reflow:
        rootElement.style.setProperty(
            '--navbarHeight', "5.5rem"
        );

        document.addEventListener("DOMContentLoaded", function() {
            updateNavbarHeight()
        });

        var interval = undefined

        window.addEventListener('resize', () => {
            if (interval) {
                clearTimeout(interval)
            }
            interval = setTimeout(() => {
                console.log("Finished resizing")
                updateNavbarHeight()
            }, 100)
        })
    }

    /*************************************************************************/

    PetiteVue.createApp({
        visible: !alreadyRead,
        permanentlyHidden: permanentlyHidden,
        bannerHiding: bannerHiding,
        $delimiters: ['[[', ']]'],
        toggleVisible() {
            this.visible = !this.visible

            if (this.visible) {
                clearRead()
            } else {
                setRead()
            }

            if (!this.visible && bannerHiding == 'permanent') {
                this.permanentlyHidden = true
            }

            // Run this after Vue has had time to update the DOM:
            setTimeout(
                updateNavbarHeight,
                0
            )
        }
    }).mount('#notification_banner')
})()
</script>
    

    <nav>
        
            
        

        <p id="toggle_sidebar">
            <a href="#" title="Toggle sidebar">|||</a>
        </p>
        <h1><a href="../index.html" title="Go to homepage">dro 0.1.1 documentation</a></h1>
            <a id="source_link" href="https://github.com/namkoong-lab/dro">
    
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512">
            <path fill="white" d="M 244.8,8 C 106.1,8 0,113.3 0,252 c 0,110.9 69.8,205.8 169.5,239.2 12.8,2.3 17.3,-5.6 17.3,-12.1 0,-6.2 -0.3,-40.4 -0.3,-61.4 0,0 -70,15 -84.7,-29.8 0,0 -11.4,-29.1 -27.8,-36.6 0,0 -22.9,-15.7 1.6,-15.4 0,0 24.9,2 38.6,25.8 21.9,38.6 58.6,27.5 72.9,20.9 2.3,-16 8.8,-27.1 16,-33.7 -55.9,-6.2 -112.3,-14.3 -112.3,-110.5 0,-27.5 7.6,-41.3 23.6,-58.9 -2.6,-6.5 -11.1,-33.3 2.6,-67.9 20.9,-6.5 69,27 69,27 20,-5.6 41.5,-8.5 62.8,-8.5 21.3,0 42.8,2.9 62.8,8.5 0,0 48.1,-33.6 69,-27 13.7,34.7 5.2,61.4 2.6,67.9 16,17.7 25.8,31.5 25.8,58.9 0,96.5 -58.9,104.2 -114.8,110.5 9.2,7.9 17,22.9 17,46.4 0,33.7 -0.3,75.4 -0.3,83.6 0,6.5 4.6,14.4 17.3,12.1 C 428.2,457.8 496,362.9 496,252 496,113.3 383.5,8 244.8,8 Z"/>
        </svg>
    
</a>
        

        <a id="mode_toggle" href="#" @click.prevent="handleClick" :title="mode">
    <template v-if="mode == 'light'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_light"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M67.48,18.073c1.913,-1.912 1.913,-5.018 0,-6.931c-1.912,-1.912 -5.018,-1.912 -6.931,0l-6.798,6.799c-1.912,1.912 -1.912,5.018 0,6.931c1.913,1.912 5.018,1.912 6.931,-0l6.798,-6.799Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.728,61.108c1.912,-1.913 1.912,-5.018 -0,-6.931c-1.913,-1.913 -5.019,-1.913 -6.931,-0l-6.799,6.798c-1.912,1.913 -1.912,5.019 0,6.931c1.913,1.913 5.019,1.913 6.931,0l6.799,-6.798Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.682,54.177c-1.913,-1.913 -5.018,-1.913 -6.931,-0c-1.912,1.913 -1.912,5.018 0,6.931l6.798,6.798c1.913,1.913 5.019,1.913 6.931,0c1.913,-1.912 1.913,-5.018 0,-6.931l-6.798,-6.798Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M4.901,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,-0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M18.929,11.142c-1.912,-1.912 -5.018,-1.912 -6.931,0c-1.912,1.913 -1.912,5.019 0,6.931l6.799,6.799c1.912,1.912 5.018,1.912 6.931,-0c1.912,-1.913 1.912,-5.019 -0,-6.931l-6.799,-6.799Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.108,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c-0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c-0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'dark'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_dark"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.901,2.196 -4.901,4.901c0,2.705 2.197,4.901 4.901,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.662,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.989,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.732,61.103c1.91,-1.91 1.91,-5.011 0,-6.921l-0.009,-0.01c-1.91,-1.91 -5.012,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.909,1.91 5.011,1.91 6.92,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.672,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.52,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l-0,-0.01c-0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.901,2.196 -4.901,4.901c0,2.704 2.197,4.9 4.901,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.73,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 -0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.098,34.623c-2.699,0 -4.891,2.192 -4.891,4.892l-0,0.019c-0,2.699 2.192,4.891 4.891,4.891c2.7,0 4.892,-2.192 4.892,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.892,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'darkest'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_darkest"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><path d="M39.315,23.791c8.684,-0 15.734,7.05 15.734,15.733c0,8.684 -7.05,15.734 -15.734,15.734c-8.683,0 -15.733,-7.05 -15.733,-15.734c-0,-8.683 7.05,-15.733 15.733,-15.733Zm0,4.737c6.069,0 10.997,4.927 10.997,10.996c-0,6.069 -4.928,10.996 -10.997,10.996c-6.068,0 -10.996,-4.927 -10.996,-10.996c0,-6.069 4.928,-10.996 10.996,-10.996Z" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.216,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.9,2.196 -4.9,4.901c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.666,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.99,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.737,61.103c1.909,-1.91 1.909,-5.011 -0,-6.921l-0.01,-0.01c-1.91,-1.91 -5.011,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.91,1.91 5.011,1.91 6.921,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.676,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.524,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l0,-0.01c0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.216,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901c-0,2.704 2.196,4.9 4.9,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.734,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.103,34.623c-2.7,0 -4.892,2.192 -4.892,4.892l-0,0.019c-0,2.699 2.192,4.891 4.892,4.891c2.699,0 4.891,-2.192 4.891,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.891,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>
</a>

<script>
(function() {
    const LOCAL_STORAGE_KEY = 'piccoloThemeMode'

    var initialMode = localStorage.getItem(LOCAL_STORAGE_KEY)

    if (initialMode) {
        // Make sure the value in local storage is valid
        if (['light', 'dark', 'darkest'].indexOf(initialMode) == -1) {
            initialMode = 'light'
            localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
        }
    } else {
        // Check if the client prefers dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            initialMode = 'dark'
        } else {
            initialMode = 'light'
        }
        localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
    }

    document.documentElement.dataset.mode = initialMode

    PetiteVue.createApp({
        'mode': initialMode,
        handleClick() {
            let currentMode = this.mode

            if (currentMode == 'light') {
                this.mode = 'dark'
            } else if (currentMode == 'dark') {
                this.mode = 'darkest'
            } else if (currentMode == 'darkest') {
                this.mode = 'light'
            }

            document.documentElement.dataset.mode = this.mode
            localStorage.setItem(LOCAL_STORAGE_KEY, this.mode)

            console.log(this.mode)
        }
    }).mount('#mode_toggle')
})()
</script>
            <p class="mobile_search_link">
                <a href="../search.html" title="Search">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 65 64" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2">
                        <path d="M14.873 40.009c-2.315-3.943-3.642-8.532-3.642-13.429C11.231 11.91 23.141 0 37.811 0s26.58 11.91 26.58 26.58-11.91 26.58-26.58 26.58a26.44 26.44 0 0 1-14.277-4.161L9.739 62.794a3.12 3.12 0 0 1-4.413 0L.913 58.382c-1.217-1.218-1.217-3.196 0-4.413l13.96-13.96zM37.811 8.054c10.225 0 18.526 8.301 18.526 18.526s-8.301 18.526-18.526 18.526-18.526-8.301-18.526-18.526S27.586 8.054 37.811 8.054z" fill="#fff" />
                    </svg>
                </a>
            </p>
        

        <div class="searchbox_wrapper">
            
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
    </nav>
</div>

    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html">Formulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/linear.html">Linear Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/linear_fdro.html">f-divergence DRO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/linear_wdro.html">Wasserstein DRO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/linear_mmddro.html">MMD-DRO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/linear_pdro.html">Bayesian-based DRO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/linear_mixdro.html">DRO with a mixture of distance metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/neural_model.html">Neural Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/personal_loss.html">Personal Loss</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a></li>
</ul>

        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this heading">¶</a></h1>
<section id="module-dro.src.data.dataloader_classification">
<span id="data-modules"></span><h2>Data Modules<a class="headerlink" href="#module-dro.src.data.dataloader_classification" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dro.src.data.dataloader_classification.classification_basic">
<span class="sig-prename descclassname"><span class="pre">dro.src.data.dataloader_classification.</span></span><span class="sig-name descname"><span class="pre">classification_basic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visualize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.data.dataloader_classification.classification_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic classification setting.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>d (int): The dimension of covariates
k (int): The number of classes
num_samples (int): The number of samples
radius (float): The radius of the ball to sample the class center
seed (int): Random seed.
visualize (bool): Whether to visualize the data
save_dir (str): The save path of the visualization figure, if set None, we just visualize instead of storing it.</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: (covariate, target) where:</dt><dd><ul class="simple">
<li><p>X (numpy.ndarray): A numpy array containing the generated covariate data</p></li>
<li><p>y (numpy.ndarray): A numpy array containing the generated target data</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dro.src.data.dataloader_classification.classification_DN21">
<span class="sig-prename descclassname"><span class="pre">dro.src.data.dataloader_classification.</span></span><span class="sig-name descname"><span class="pre">classification_DN21</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visualize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./visualization.png'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.data.dataloader_classification.classification_DN21" title="Permalink to this definition">¶</a></dt>
<dd><p>Following Section 3.1.1 of “Learning Models with Uniform Performance via Distributionally Robust Optimization”
link: <a class="reference external" href="https://arxiv.org/pdf/1810.08750">https://arxiv.org/pdf/1810.08750</a></p>
<dl class="simple">
<dt>Args:</dt><dd><p>d (int): The dimension of covariates
flip_ratio (float): The ratio of labels to be flipped
num_samples (int): The number of samples
seed (int): Random seed.
visualize (bool): Whether to visualize the data
save_dir (str): The save path of the visualization figure</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: (covariat, target) where:</dt><dd><ul class="simple">
<li><p>X (numpy.ndarray): A numpy array containing the generated covariate data</p></li>
<li><p>y_noisy (numpy.ndarray): A numpy array containing the generated target data</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dro.src.data.dataloader_classification.classification_SNVD20">
<span class="sig-prename descclassname"><span class="pre">dro.src.data.dataloader_classification.</span></span><span class="sig-name descname"><span class="pre">classification_SNVD20</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visualize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./visualization.png'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.data.dataloader_classification.classification_SNVD20" title="Permalink to this definition">¶</a></dt>
<dd><p>Following Section 5.1 of “Certifying Some Distributional Robustness with Principled Adversarial Training”
link: <a class="reference external" href="https://arxiv.org/pdf/1710.10571">https://arxiv.org/pdf/1710.10571</a></p>
<dl class="simple">
<dt>Args:</dt><dd><p>num_samples (int): The number of samples
seed (int): Random seed.
visualize (bool): Whether to visualize the data
save_dir (str): The save path of the visualization figure</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: (covariate, target) where:</dt><dd><ul class="simple">
<li><p>X_filtered (numpy.ndarray): A numpy array containing the generated covariate data</p></li>
<li><p>y_filtered (numpy.ndarray): A numpy array containing the generated target data</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dro.src.data.dataloader_classification.classification_LWLC">
<span class="sig-prename descclassname"><span class="pre">dro.src.data.dataloader_classification.</span></span><span class="sig-name descname"><span class="pre">classification_LWLC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scramble</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visualize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./visualization.png'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.data.dataloader_classification.classification_LWLC" title="Permalink to this definition">¶</a></dt>
<dd><p>Following Section 4.1 (Classification) of “Distributionally Robust Optimization with Data Geometry”
link: <a class="reference external" href="https://proceedings.neurips.cc/paper_files/paper/2022/file/da535999561b932f56efdd559498282e-Paper-Conference.pdf">https://proceedings.neurips.cc/paper_files/paper/2022/file/da535999561b932f56efdd559498282e-Paper-Conference.pdf</a></p>
<p>Args:
- num_samples (int): The number of samples
- d (int): The dimension of feature S and V
- bias (float): The bias ratio in (0,1)
- scramble (bool): Whether to mix the features S and V
- sigma_s (float): The variance of the Guassian distribution to sample the feature S
- sigma_v (float): The variance of the Guassian distribution to sample the feature V
- high_dimension (int): The final dimension of X
- seed (int): Random seed.
- visualize (bool): Whether to visualize the data
- save_dir (str): The save path of the visualization figure</p>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: (covariate, target) where:</dt><dd><ul class="simple">
<li><p>X (numpy.ndarray): A numpy array containing the generated (high-dimensional) covariate data</p></li>
<li><p>y (numpy.ndarray): A numpy array containing the generated target data</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-dro.src.data.dataloader_regression"></span><dl class="py function">
<dt class="sig sig-object py" id="dro.src.data.dataloader_regression.regression_basic">
<span class="sig-prename descclassname"><span class="pre">dro.src.data.dataloader_regression.</span></span><span class="sig-name descname"><span class="pre">regression_basic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.data.dataloader_regression.regression_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic regression setting.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>num_samples (int): The number of samples
d (int): The dimension of covariates
noise (float): The variance of the noise term
seed (int): Random seed.</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: (covariate, target) where:</dt><dd><ul class="simple">
<li><p>X (numpy.ndarray): A numpy array containing the generated covariate data</p></li>
<li><p>y (numpy.ndarray): A numpy array containing the generated target data</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dro.src.data.dataloader_regression.regression_DN20_1">
<span class="sig-prename descclassname"><span class="pre">dro.src.data.dataloader_regression.</span></span><span class="sig-name descname"><span class="pre">regression_DN20_1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.data.dataloader_regression.regression_DN20_1" title="Permalink to this definition">¶</a></dt>
<dd><p>Following Section 3.1.2 of “Learning Models with Uniform Performance via Distributionally Robust Optimization”
link: <a class="reference external" href="https://arxiv.org/pdf/1810.08750">https://arxiv.org/pdf/1810.08750</a></p>
<dl class="simple">
<dt>Args:</dt><dd><p>num_samples (int): The number of samples
d (int): The dimension of covariates
noise (float): The variance of the noise term
seed (int): Random seed.</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: (covariate, target) where:</dt><dd><ul class="simple">
<li><p>X (numpy.ndarray): A numpy array containing the generated covariate data</p></li>
<li><p>y (numpy.ndarray): A numpy array containing the generated target data</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dro.src.data.dataloader_regression.regression_DN20_2">
<span class="sig-prename descclassname"><span class="pre">dro.src.data.dataloader_regression.</span></span><span class="sig-name descname"><span class="pre">regression_DN20_2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.data.dataloader_regression.regression_DN20_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Following Section 3.1.3 of “Learning Models with Uniform Performance via Distributionally Robust Optimization”
link: <a class="reference external" href="https://arxiv.org/pdf/1810.08750">https://arxiv.org/pdf/1810.08750</a></p>
<dl class="simple">
<dt>Args:</dt><dd><p>num_samples (int): The number of samples
prob (float): the minority group ratio in (0,1)
noise (float): The variance of the noise term
seed (int): Random seed.</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: (covariate, target) where:</dt><dd><ul class="simple">
<li><p>X (numpy.ndarray): A numpy array containing the generated covariate data</p></li>
<li><p>y (numpy.ndarray): A numpy array containing the generated target data</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dro.src.data.dataloader_regression.regression_DN20_3">
<span class="sig-prename descclassname"><span class="pre">dro.src.data.dataloader_regression.</span></span><span class="sig-name descname"><span class="pre">regression_DN20_3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./data/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">download</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.data.dataloader_regression.regression_DN20_3" title="Permalink to this definition">¶</a></dt>
<dd><p>Following Section 3.3 of “Learning Models with Uniform Performance via Distributionally Robust Optimization”
link: <a class="reference external" href="https://arxiv.org/pdf/1810.08750">https://arxiv.org/pdf/1810.08750</a></p>
<p>Data is from UCI repository: <a class="reference external" href="https://archive.ics.uci.edu/dataset/183/communities+and+crime">https://archive.ics.uci.edu/dataset/183/communities+and+crime</a></p>
<dl class="simple">
<dt>Args:</dt><dd><p>save_dir (str): The path to save the data
download (bool): Whether to download the data. If not, will load the data according to the save_dir</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: (covariate, target) where:</dt><dd><ul class="simple">
<li><p>X (numpy.ndarray): A numpy array containing the generated covariate data</p></li>
<li><p>y (numpy.ndarray): A numpy array containing the generated target data</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dro.src.data.dataloader_regression.regression_LWLC">
<span class="sig-prename descclassname"><span class="pre">dro.src.data.dataloader_regression.</span></span><span class="sig-name descname"><span class="pre">regression_LWLC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pvb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scramble</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.data.dataloader_regression.regression_LWLC" title="Permalink to this definition">¶</a></dt>
<dd><p>Following Section 4.1 (Regression) of “Distributionally Robust Optimization with Data Geometry”
link: <a class="reference external" href="https://proceedings.neurips.cc/paper_files/paper/2022/file/da535999561b932f56efdd559498282e-Paper-Conference.pdf">https://proceedings.neurips.cc/paper_files/paper/2022/file/da535999561b932f56efdd559498282e-Paper-Conference.pdf</a></p>
<dl class="simple">
<dt>Args:</dt><dd><p>n1 (int): The total number of samples in the pool
n2 (int): The number of samples required
ps (int): The dimension of feature S
pvb (int): The dimension of feature Vb
pv (int): The dimension of other features in V (except for Vb)
r (float): The adjustment parameter to control the spurious correlation with abs(r)&gt;1. Higher abs(r) denotes stronger spurious correlation, and sign(r) controls the direction of spurious correlation
scramble (bool): Whether to mix the features S and V.</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: (covariate, target) where:</dt><dd><ul class="simple">
<li><p>X (numpy.ndarray): A numpy array containing the generated covariate data</p></li>
<li><p>y (numpy.ndarray): A numpy array containing the generated target data</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dro.src.linear_model.base">
<span id="linear-dro-methods"></span><h2>Linear DRO Methods<a class="headerlink" href="#module-dro.src.linear_model.base" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dro.src.linear_model.base.BaseLinearDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.linear_model.base.</span></span><span class="sig-name descname"><span class="pre">BaseLinearDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOSEK'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.base.BaseLinearDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for Linear Distributionally Robust Optimization (DRO) models.</p>
<p>This class supports both regression and binary classification tasks. To ensure convex optimization,
this class only supports linear models, e.g., SVM, Linear Regression, and Logistic Regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimensionality of the input features.</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Model type indicator (‘svm’ for SVM, ‘logistic’ for Logistic Regression, ‘ols’ for Linear Regression for OLS, ‘lad’ for Linear Regression for LAD), default = ‘svm’.</p></li>
<li><p><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to calculate the intercept for this model. If set to False, no intercept will be used in calculations (i.e. data is expected to be centered), default = True.</p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Optimization solver to solve the problem, default = ‘MOSEK’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.base.BaseLinearDRO.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.base.BaseLinearDRO.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update model parameters based on configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – The model configuration</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.base.BaseLinearDRO.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.base.BaseLinearDRO.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit model to data by solving an optimization problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – input covariates</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – input labels</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.base.BaseLinearDRO.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.base.BaseLinearDRO.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load model parameters from a configuration dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – The model configuration to load</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.base.BaseLinearDRO.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.base.BaseLinearDRO.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict output based on input data and model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Input covariates</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the predicted labels</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.base.BaseLinearDRO.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.base.BaseLinearDRO.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute accuracy and F1 score for classification tasks, or MSE for regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Input feature matrix of shape (n_samples, n_features)</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Target labels/values of shape (n_samples,)</p></li>
<li><p><strong>weights</strong> (Optional[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>], defaults to None) – Sample weight vector of shape (n_samples,), None indicates equal weights</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>For classification: Tuple containing (accuracy, F1-score)</p></li>
<li><p>For regression: Mean Squared Error (MSE)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>, Tuple[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If task type is not properly configured</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Classification</span> <span class="n">model</span><span class="p">:</span> <span class="n">Returns</span> <span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Regression</span> <span class="n">model</span><span class="p">:</span> <span class="n">Returns</span> <span class="mf">3.1415</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.base.BaseLinearDRO.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.base.BaseLinearDRO.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Fast evaluate the true model performance for the obtained theta efficiently from data unbiased</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a>) – </p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a>) – </p></li>
<li><p><strong>fast</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-dro.src.linear_model.chi2_dro"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.linear_model.chi2_dro.Chi2DRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.linear_model.chi2_dro.</span></span><span class="sig-name descname"><span class="pre">Chi2DRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOSEK'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.chi2_dro.Chi2DRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO" title="dro.src.linear_model.base.BaseLinearDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLinearDRO</span></code></a></p>
<p>Chi-squared Distributionally Robust Optimization (chi2-DRO) model.</p>
<p>This model minimizes a chi-squared robust loss function for both regression and classification.</p>
<p>Reference: &lt;<a class="reference external" href="https://www.jmlr.org/papers/volume20/17-750/17-750.pdf">https://www.jmlr.org/papers/volume20/17-750/17-750.pdf</a>&gt;</p>
<p>Initialize the Chi-squared Distributionally Robust Optimization (Chi2-DRO) model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimensionality of the input feature space. 
Must match the number of columns in the training data.</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Type of base model to robustify. Defaults to ‘svm’.
Supported types:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'svm'</span></code>: Support Vector Machine (hinge loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'logistic'</span></code>: Logistic Regression (log loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ols'</span></code>: Ordinary Least Squares (L2 loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lad'</span></code>: Least Absolute Deviation (L1 loss)</p></li>
</ul>
</p></li>
<li><p><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to learn an intercept/bias term. 
If False, assumes data is already centered. Defaults to True.</p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Convex optimization solver. 
Recommended solvers: 
- <code class="docutils literal notranslate"><span class="pre">'MOSEK'</span></code> (requires license)
Defaults to ‘MOSEK’.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If <cite>model_type</cite> is not in [‘svm’, ‘logistic’, ‘ols’, ‘lad’]</p></li>
<li><p>If <cite>input_dim</cite> ≤ 0</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>‘lad’ (L1 loss) produces sparse solutions but requires longer solve times</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.chi2_dro.Chi2DRO.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.chi2_dro.Chi2DRO.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the Chi-squared DRO model configuration parameters.</p>
<p>Dynamically modify robustness settings and optimization parameters after model initialization.
Changes will affect subsequent operations (e.g., re-fitting the model).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – <p>Dictionary containing configuration updates. Supported keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">eps</span></code>: Robustness parameter controlling the size of the chi-squared ambiguity set (must be ≥ 0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solver</span></code>: Optimization solver to use (must be installed)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Chi2DROError</strong> – <ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">eps</span></code> is not a non-negative numeric value</p></li>
<li><p>If unrecognized configuration keys are provided</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Chi2DRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;eps&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>  <span class="c1"># Valid update</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">eps</span>  <span class="c1"># Verify new value</span>
<span class="go">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;eps&quot;</span><span class="p">:</span> <span class="s2">&quot;invalid&quot;</span><span class="p">})</span>  <span class="c1"># Will raise error</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">Chi2DROError</span>: <span class="n">Robustness parameter &#39;eps&#39; must be a non-negative float.</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Configuration changes don’t trigger automatic re-optimization</p></li>
<li><p>Larger <code class="docutils literal notranslate"><span class="pre">eps</span></code> values make solutions more conservative</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.chi2_dro.Chi2DRO.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.chi2_dro.Chi2DRO.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the Chi-squared DRO model by solving the convex optimization problem.</p>
<p>Constructs and solves the distributionally robust optimization problem using CVXPY,
where the ambiguity set is defined by the chi-squared divergence. The optimization
objective and constraints are built dynamically based on input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Training feature matrix. Must have shape <cite>(n_samples, n_features)</cite>,
where <cite>n_features</cite> should match the <cite>input_dim</cite> specified during initialization.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Target values. For classification tasks, expected to be binary (±1 labels).
Shape must be <cite>(n_samples,)</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing the trained model parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">theta</span></code>: Weight vector of shape <cite>(n_features,)</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code>: Intercept term (only present if <cite>fit_intercept=True</cite>)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Chi2DROError</strong> – <ul>
<li><p>If the optimization solver fails to converge</p></li>
<li><p>If the problem is infeasible due to invalid hyperparameters</p></li>
</ul>
</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul>
<li><p>If <cite>X</cite> and <cite>y</cite> have inconsistent sample sizes (<cite>X.shape[0] != y.shape[0]</cite>)</p></li>
<li><p>If <cite>X</cite> has incorrect feature dimension (<cite>X.shape[1] != input_dim</cite>)</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Optimization Problem:</dt><dd><div class="math notranslate nohighlight">
\[\min_{\theta,b} \max_{P \in \mathcal{P}} \mathbb{E}_P[\ell(\theta, b; X, y)]\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{P}\)</span> is the ambiguity set defined by chi-squared divergence:</p>
<div class="math notranslate nohighlight">
\[\mathcal{P} = \{ P: D_{\chi^2}(P \| P_0) \leq \epsilon \}\]</div>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Chi2DRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>  <span class="c1"># Binary labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (5,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;b&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="p">)</span>  <span class="c1"># True</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Large values of <cite>eps</cite> increase robustness but may lead to conservative solutions</p></li>
<li><p>Warm-starting is not supported due to DRO problem structure</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.chi2_dro.Chi2DRO.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.chi2_dro.Chi2DRO.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate model performance with bias-corrected mean squared error (MSE).</p>
<p>Specifically designed for OLS models to compute an unbiased performance estimate 
by adjusting for the covariance structure of the features. This implementation 
accelerates evaluation by avoiding full retraining.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Feature matrix of shape <cite>(n_samples, n_features)</cite>. 
Must match the model’s <cite>input_dim</cite> (n_features).</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Target values of shape <cite>(n_samples,)</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Bias-corrected MSE for OLS models. Returns raw MSE for other model types.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul>
<li><p>If <cite>X</cite> and <cite>y</cite> have inconsistent sample sizes</p></li>
<li><p>If <cite>X</cite> feature dimension ≠ <cite>input_dim</cite></p></li>
</ul>
</p></li>
<li><p><strong>LinAlgError</strong> – If feature covariance matrix is singular (non-invertible)</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Chi2DRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;ols&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Corrected MSE: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Currently, bias correction is only implemented for <code class="docutils literal notranslate"><span class="pre">model_type='ols'</span></code>; other model types return the raw MSE.</p></li>
<li><p>Covariance matrix computation uses pseudo-inverse to handle high-dimensional data (<code class="docutils literal notranslate"><span class="pre">n_features</span> <span class="pre">&gt;</span> <span class="pre">n_samples</span></code>).</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.chi2_dro.Chi2DRO.worst_distribution">
<span class="sig-name descname"><span class="pre">worst_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.chi2_dro.Chi2DRO.worst_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the worst-case distribution within the chi-squared ambiguity set.</p>
<p>This method solves a convex optimization problem to find the probability distribution 
that maximizes the expected loss under the chi-squared divergence constraint. The result
characterizes the adversarial data distribution the model is robust against.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Feature matrix of shape <cite>(n_samples, n_features)</cite>. 
Must match the model’s <cite>input_dim</cite> (n_features).</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Target vector of shape <cite>(n_samples,)</cite>. For regression tasks, continuous values 
are expected; for classification, ±1 labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sample_pts</span></code>: Original data points as a tuple <code class="docutils literal notranslate"><span class="pre">(X,</span> <span class="pre">y)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight</span></code>: Worst-case probability weights of shape <cite>(n_samples,)</cite></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Chi2DROError</strong> – <ul>
<li><p>If the optimization solver fails to converge</p></li>
<li><p>If the solution is infeasible or returns null weights</p></li>
</ul>
</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul>
<li><p>If <cite>X</cite> and <cite>y</cite> have inconsistent sample sizes</p></li>
<li><p>If <cite>X</cite> feature dimension ≠ <cite>input_dim</cite></p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Optimization Formulation:</dt><dd><div class="math notranslate nohighlight">
\[\max_{p \in \Delta} \ \sum_{i=1}^n p_i \cdot \ell_i 
\ \ \ s.t. \ \sum_{i=1}^n n(p_i - 1/n)^2 \leq \epsilon\]</div>
<p>where:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\ell_i\)</span> is the loss for the i-th sample</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta\)</span> is the probability simplex</p></li>
<li><p><span class="math notranslate nohighlight">\(\epsilon\)</span> is the robustness parameter <code class="docutils literal notranslate"><span class="pre">self.eps</span></code></p></li>
</ul>
</div></blockquote>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Chi2DRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>  <span class="c1"># Binary labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">worst_distribution</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (100,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>  <span class="c1"># Sum to 1</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The weights are guaranteed to be non-negative and sum to 1</p></li>
<li><p>Larger <code class="docutils literal notranslate"><span class="pre">eps</span></code> allows more deviation from the empirical distribution</p></li>
<li><p>Requires prior model fitting via <a class="reference internal" href="#dro.src.linear_model.chi2_dro.Chi2DRO.fit" title="dro.src.linear_model.chi2_dro.Chi2DRO.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a></p></li>
</ul>
</div>
</dd></dl>

</dd></dl>

<span class="target" id="module-dro.src.linear_model.cvar_dro"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.linear_model.cvar_dro.CVaRDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.linear_model.cvar_dro.</span></span><span class="sig-name descname"><span class="pre">CVaRDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOSEK'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.cvar_dro.CVaRDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO" title="dro.src.linear_model.base.BaseLinearDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLinearDRO</span></code></a></p>
<p>Conditional Value-at-Risk (CVaR) Distributionally Robust Optimization (DRO) model.</p>
<p>This model minimizes a robust loss function for both regression and classification tasks
under a CVaR constraint.</p>
<p>Reference: &lt;<a class="reference external" href="https://www.risk.net/journal-risk/2161159/optimization-conditional-value-risk">https://www.risk.net/journal-risk/2161159/optimization-conditional-value-risk</a>&gt;</p>
<p>Initialize a CVaR-constrained DRO model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of input features. Must match training data dimension.</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Base model type. Valid options: ‘svm’ (SVM), ‘logistic’ (Logistic Regression), 
‘ols’ (Linear Regression). Defaults to ‘svm’.</p></li>
<li><p><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to learn an intercept term. Disable if data is pre-centered.
Defaults to True.</p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Convex optimization solver. Recommended: ‘MOSEK’ (commercial).
Defaults to ‘MOSEK’.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Risk level controlling the CVaR conservativeness. Must satisfy 0 &lt; alpha ≤ 1.
Defaults to 1.0 (equivalent to worst-case optimization).</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">model_type</span></code> is not in [‘svm’, ‘logistic’, ‘ols’]</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is outside (0, 1]</p></li>
</ul>
</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.cvar_dro.CVaRDRO.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.cvar_dro.CVaRDRO.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Dynamically update CVaR-DRO model configuration parameters.</p>
<p>Modifies risk-sensitive hyperparameters and optimization settings. Changes take effect immediately but require re-fitting the model to update solutions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – <p>Dictionary of configuration updates. Supported keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alpha</span></code>: Risk level parameter controlling CVaR conservativeness (must satisfy 0 &lt; alpha ≤ 1)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>CVaRDROError</strong> – <ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is not in (0, 1]</p></li>
<li><p>If unrecognized configuration keys are provided (future-proofing)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">CVaRDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">})</span>  <span class="c1"># Valid adjustment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">alpha</span>
<span class="go">0.9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">})</span>  <span class="c1"># Invalid value</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">CVaRDROError</span>: <span class="n">Risk parameter &#39;alpha&#39; must be in the range (0, 1].</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Decreasing <code class="docutils literal notranslate"><span class="pre">alpha</span></code> makes the model less conservative (focuses on average risk)</p></li>
<li><p>Requires manual re-fitting via <a class="reference internal" href="#dro.src.linear_model.cvar_dro.CVaRDRO.fit" title="dro.src.linear_model.cvar_dro.CVaRDRO.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> after configuration changes</p></li>
<li><p>Configuration keys other than <code class="docutils literal notranslate"><span class="pre">alpha</span></code> will be silently ignored</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.cvar_dro.CVaRDRO.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.cvar_dro.CVaRDRO.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the CVaR-constrained distributionally robust optimization problem.</p>
<p>Constructs and solves the convex optimization problem to find model parameters 
that minimize the worst-case CVaR of the loss distribution. The solution defines 
a robust decision boundary/regression plane under adversarial distribution shifts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Training feature matrix of shape <cite>(n_samples, n_features)</cite>. 
Must match the <cite>input_dim</cite> specified during initialization.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Target values of shape <cite>(n_samples,)</cite>. For classification, use ±1 labels; 
for regression, use continuous values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing trained parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">theta</span></code>: Weight vector of shape <cite>(n_features,)</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">threshold</span></code>: Optimal CVaR threshold value (stored as <code class="docutils literal notranslate"><span class="pre">self.threshold_val</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code>: Intercept term (only present if <cite>fit_intercept=True</cite>)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>CVaRDROError</strong> – <ul>
<li><p>If the optimization solver fails to converge</p></li>
<li><p>If the problem is infeasible with current <cite>alpha</cite></p></li>
</ul>
</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul>
<li><p>If <cite>X.shape[1] != self.input_dim</cite></p></li>
<li><p>If <cite>X.shape[0] != y.shape[0]</cite></p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Optimization Formulation:</dt><dd><div class="math notranslate nohighlight">
\[\min_{\theta,b} \ CVaR_\alpha(\ell(\theta, b; X, y)) \]</div>
<p>where:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(CVaR_\alpha\)</span> = Conditional Value-at-Risk at level <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\ell\)</span> = model-specific loss (hinge loss for SVM, squared loss for OLS, etc.)</p></li>
</ul>
</div></blockquote>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">CVaRDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (3,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="p">)</span>  <span class="c1"># True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">threshold_val</span> <span class="o">==</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;threshold&quot;</span><span class="p">])</span>  <span class="c1"># True</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Higher <span class="math notranslate nohighlight">\(\alpha\)</span> values require solving more conservative (pessimistic) scenarios</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">threshold</span></code> value represents the <span class="math notranslate nohighlight">\(\alpha\)</span>-quantile of the loss distribution</p></li>
<li><p>Warm-starting not supported due to CVaR’s non-smooth nature</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.cvar_dro.CVaRDRO.worst_distribution">
<span class="sig-name descname"><span class="pre">worst_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.cvar_dro.CVaRDRO.worst_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the worst-case distribution under CVaR constraint.</p>
<p>Identifies samples contributing to the alpha-tail risk distribution and assigns uniform weights to these 
high-loss scenarios. This represents the adversarial distribution that maximizes the conditional expected loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Feature matrix of shape <cite>(n_samples, n_features)</cite>.
Must match the model’s <cite>input_dim</cite> (n_features).</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – <p>Target vector of shape <cite>(n_samples,)</cite>. Requires pre-processed labels:</p>
<ul>
<li><p>Binary classification: ±1 labels</p></li>
<li><p>Regression: Continuous values</p></li>
</ul>
</p></li>
<li><p><strong>precision</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Perturbation tolerance for loss threshold comparison. 
Compensates for numerical instability in loss computations. Defaults to 1e-5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing:</p>
<p>-<code class="docutils literal notranslate"><span class="pre">sample_pts</span></code>: Tuple of filtered feature matrix and targets <code class="docutils literal notranslate"><span class="pre">(X_high,</span> <span class="pre">y_high)</span></code>, where <cite>X_high</cite> shape = <cite>(n_high_risk, n_features)</cite></p>
<p>-<code class="docutils literal notranslate"><span class="pre">weight</span></code>: Uniform probability weights of shape <cite>(n_high_risk,)</cite> summing to 1</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>CVaRDROError</strong> – <ul class="simple">
<li><p>If model hasn’t been fitted (threshold_val is None)</p></li>
<li><p>If all sample losses fall below CVaR threshold (empty distribution)</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Optimization Formulation:</dt><dd><div class="math notranslate nohighlight">
\[\mathcal{P}_{\text{worst}} = \{ (X_i,y_i) \mid \ell(\theta;X_i,y_i) &gt; \tau_\alpha + \epsilon \}\]</div>
<p>where:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\tau_\alpha\)</span> = CVaR threshold from <a class="reference internal" href="#dro.src.linear_model.cvar_dro.CVaRDRO.fit" title="dro.src.linear_model.cvar_dro.CVaRDRO.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a></p></li>
<li><p><span class="math notranslate nohighlight">\(\epsilon\)</span> = precision parameter</p></li>
<li><p>Weights are assigned uniformly: <span class="math notranslate nohighlight">\(p_i = 1 / |\mathcal{P}_{\text{worst}}|\)</span></p></li>
</ul>
</div></blockquote>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">CVaRDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">worst_distribution</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">high_risk_X</span><span class="p">,</span> <span class="n">high_risk_y</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="s2">&quot;sample_pts&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">high_risk_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]))</span>  <span class="c1"># True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The returned distribution always includes samples with loss values exceeding <span class="math notranslate nohighlight">\(\tau_\alpha + \epsilon\)</span>, where:</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau_\alpha\)</span> is the CVaR threshold from the fitted model</p></li>
<li><p><span class="math notranslate nohighlight">\(\epsilon\)</span> (epsilon) is the <code class="docutils literal notranslate"><span class="pre">precision</span></code> parameter</p></li>
<li><p>If all sample losses are below :math:`    au_lpha + epsilon`, returns an empty weight array and raises a <code class="docutils literal notranslate"><span class="pre">UserWarning</span></code></p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">precision</span></code> parameter mitigates false positives/negates from floating-point errors in loss comparisons (default=1e-5)</p></li>
</ul>
</div>
</dd></dl>

</dd></dl>

<span class="target" id="module-dro.src.linear_model.kl_dro"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.linear_model.kl_dro.KLDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.linear_model.kl_dro.</span></span><span class="sig-name descname"><span class="pre">KLDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOSEK'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.kl_dro.KLDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO" title="dro.src.linear_model.base.BaseLinearDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLinearDRO</span></code></a></p>
<p>Kullback-Leibler divergence-based Distributionally Robust Optimization (KL-DRO) model.</p>
<p>This model minimizes a KL-robust loss function for both regression and classification.</p>
<p>Reference: &lt;<a class="reference external" href="https://optimization-online.org/wp-content/uploads/2012/11/3677.pdf">https://optimization-online.org/wp-content/uploads/2012/11/3677.pdf</a>&gt;</p>
<p>Initialize KL-divergence Distributionally Robust Optimization model.</p>
<p>Inherits from BaseLinearDRO and configures KL ambiguity set parameters. 
The ambiguity set is defined by:</p>
<div class="math notranslate nohighlight">
\[\mathcal{Q} = \{ Q \ll P \, | \, D_{KL}(Q\|P) \leq \epsilon \}\]</div>
<p>where <span class="math notranslate nohighlight">\(D_{KL}\)</span> is Kullback–Leibler divergence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimension of input features. Must match training data features.</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Base model type specification:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'svm'</span></code>: Support Vector Machine (hinge loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'logistic'</span></code>: Logistic Regression (log loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ols'</span></code>: Ordinary Least Squares (<span class="math notranslate nohighlight">\(L_2\)</span> loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lad'</span></code>: Least Absolute Deviation (<span class="math notranslate nohighlight">\(L_1\)</span> loss)</p></li>
</ul>
</p></li>
<li><p><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, adds intercept term <span class="math notranslate nohighlight">\(b\)</span> to linear model:
<span class="math notranslate nohighlight">\(\theta^T X + b\)</span>
Disable when data is pre-centered.</p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Convex optimization solver, supported values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'MOSEK'</span></code> (recommended): Requires academic/commercial license</p></li>
</ul>
</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – <p>KL divergence bound (ε ≥ 0). Special cases:</p>
<ul>
<li><p>ε = 0: Reduces to standard empirical risk minimization (no distributional robustness)</p></li>
<li><p>ε → ∞: Approaches worst-case distribution (maximally conservative). Typical practical range: 0.01 ≤ ε ≤ 5.0</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If input_dim ≤ 0</p></li>
<li><p>If model_type not in allowed set</p></li>
<li><p>If eps &lt; 0</p></li>
<li><p>If unsupported solver specified</p></li>
</ul>
</p>
</dd>
</dl>
<p>Attribute Initialization:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self.dual_variable</span></code>: Stores optimal dual variable λ* after calling <code class="docutils literal notranslate"><span class="pre">fit()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self._p</span></code>: Internal probability vector of shape (n_samples,)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self._solver_opts</span></code>: Solver-specific options parsed from global config</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">KLDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;logistic&#39;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">input_dim</span>  <span class="c1"># 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">eps</span>  <span class="c1"># 0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">dual_variable</span>  <span class="c1"># None (until fit is called)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.kl_dro.KLDRO.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.kl_dro.KLDRO.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update KL-DRO model configuration parameters dynamically.</p>
<p>Primarily handles robustness parameter (eps) updates while maintaining 
optimization problem structure. Preserves existing dual variables until
next <code class="docutils literal notranslate"><span class="pre">fit()</span></code> call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – <p>Configuration dictionary containing parameters to update.
Recognized keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">eps</span></code>: (float) New KL divergence bound (ε ≥ 0). Other keys are silently ignored.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>KLDROError</strong> – <ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">eps</span></code> value is invalid (not float/int or negative)</p></li>
<li><p>If provided <code class="docutils literal notranslate"><span class="pre">eps</span></code> &gt; 100.0 (empirical stability threshold)</p></li>
</ul>
</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If config is not a dictionary</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">KLDRO</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;eps&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">eps</span>  <span class="c1"># 0.8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;invalid_key&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>  <span class="c1"># No-op</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.kl_dro.KLDRO.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.kl_dro.KLDRO.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve KL-constrained distributionally robust optimization problem.</p>
<p>Constructs and solves the convex optimization problem:</p>
<div class="math notranslate nohighlight">
\[\min_{\theta,b}  \quad \sup_{Q \in \mathcal{Q}} \mathbb{E}_Q[\ell(\theta,b;X,y)],\quad 
\text{s.t.} \quad D_{KL}(Q\|P) \leq \epsilon\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{Q}\)</span> is the ambiguity set defined by KL divergence constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Training feature matrix of shape <cite>(n_samples, n_features)</cite>.
Must satisfy <cite>n_features == self.input_dim</cite>.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – <p>Target values of shape <cite>(n_samples,)</cite>. Format requirements:</p>
<ul>
<li><p>Classification: Binary labels in {-1, +1}</p></li>
<li><p>Regression: Continuous real values</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Solution dictionary containing:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">theta</span></code>: Weight vector of shape <cite>(n_features,)</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code>: Intercept term (present if <cite>fit_intercept=True</cite>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dual</span></code>: Optimal dual variable for KL constraint (λ*)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>KLDROError</strong> – <ul>
<li><p>If problem is infeasible with current parameters</p></li>
<li><p>If solver fails to converge</p></li>
</ul>
</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul>
<li><p>If <cite>X.shape[1] != self.input_dim</cite></p></li>
<li><p>If <cite>X.shape[0] != y.shape[0]</cite></p></li>
<li><p>If classification labels not in {-1, +1}</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">KLDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>  <span class="c1"># Binary classification</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solution</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (3,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dual variable: </span><span class="si">{</span><span class="n">solution</span><span class="p">[</span><span class="s1">&#39;dual&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.kl_dro.KLDRO.worst_distribution">
<span class="sig-name descname"><span class="pre">worst_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.kl_dro.KLDRO.worst_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the worst-case distribution under KL divergence constraint.</p>
<p>The worst-case distribution weights are computed via exponential tilting:</p>
<div class="math notranslate nohighlight">
\[w_i = \frac{\exp(\ell(\theta^*;x_i,y_i)/\lambda^*)}{\sum_j \exp(\ell(\theta^*;x_j,y_j)/\lambda^*)}\]</div>
<p>where <span class="math notranslate nohighlight">\(\theta^*\)</span> is the optimal model parameter and <span class="math notranslate nohighlight">\(\lambda^*\)</span> is the optimal dual variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Feature matrix of shape <cite>(n_samples, n_features)</cite>.
Must match <code class="docutils literal notranslate"><span class="pre">self.input_dim</span></code> and training data dimension.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – <p>Target vector of shape <cite>(n_samples,)</cite>. Format constraints:</p>
<ul>
<li><p>Classification: Labels in {-1, +1}</p></li>
<li><p>Regression: Continuous values</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Worst-case distribution specification containing:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sample_pts</span></code>: Original samples [X, y] (reference to inputs)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight</span></code>: Probability vector of shape <cite>(n_samples,)</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entropy</span></code>: KL divergence <span class="math notranslate nohighlight">\(D_{KL}(Q^*\|P)\)</span></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>KLDROError</strong> – <ul>
<li><p>If inner optimization via <code class="docutils literal notranslate"><span class="pre">fit()</span></code> fails</p></li>
<li><p>If <span class="math notranslate nohighlight">\(\lambda^* \leq 0\)</span> (invalid dual variable)</p></li>
<li><p>If weight normalization fails (sum → 0)</p></li>
</ul>
</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul>
<li><p>If input dimensions mismatch</p></li>
<li><p>If classification labels violate binary constraints</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">KLDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">worst_distribution</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span><span class="p">[</span><span class="s2">&quot;sample_pts]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span><span class="p">[</span><span class="s2">&quot;weight]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-dro.src.linear_model.tv_dro"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.linear_model.tv_dro.TVDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.linear_model.tv_dro.</span></span><span class="sig-name descname"><span class="pre">TVDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOSEK'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.tv_dro.TVDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO" title="dro.src.linear_model.base.BaseLinearDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLinearDRO</span></code></a></p>
<p>Total Variation Distributionally Robust Optimization (TV-DRO) model.</p>
<p>Implements DRO with TV ambiguity set defined as:</p>
<div class="math notranslate nohighlight">
\[\mathcal{P} = \{ Q \, | \, \text{TV}(Q, P) \leq \epsilon \}\]</div>
<p>where <span class="math notranslate nohighlight">\(\text{TV}\)</span> is the total variation distance.</p>
<p>Initialize TV-constrained DRO model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Feature space dimension. Must be ≥ 1</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Base model type. Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'svm'</span></code>: Support Vector Machine (hinge loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'logistic'</span></code>: Logistic Regression (log loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ols'</span></code>: Ordinary Least Squares (L2 loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lad'</span></code>: Least Absolute Deviation (L1 loss)</p></li>
</ul>
</p></li>
<li><p><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to learn intercept term <span class="math notranslate nohighlight">\(b\)</span>.
Disable for pre-centered data. Defaults to True.</p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Convex optimization solver. Recommended:
- <code class="docutils literal notranslate"><span class="pre">'MOSEK'</span></code> (commercial)</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – <p>TV ambiguity radius. Special cases:</p>
<ul>
<li><p>0: Standard empirical risk minimization</p></li>
<li><p>&gt;0: Controls distributional robustness</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If input_dim &lt; 1</p></li>
<li><p>If model_type not in {‘svm’, ‘logistic’, ‘ols’, ‘lad’}</p></li>
<li><p>If eps &lt; 0</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">TVDRO</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">eps</span><span class="o">=</span><span class="mf">0.1</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">eps</span>  <span class="c1"># 0.1</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dro.src.linear_model.tv_dro.TVDRO.threshold_val">
<span class="sig-name descname"><span class="pre">threshold_val</span></span><a class="headerlink" href="#dro.src.linear_model.tv_dro.TVDRO.threshold_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Decision boundary threshold (set during fitting)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.tv_dro.TVDRO.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.tv_dro.TVDRO.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the model configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – <p>Dictionary containing configuration updates. Supported keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">eps</span></code>: Robustness parameter controlling the size of the chi-squared ambiguity set (must be ≥ 0)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TVDROError</strong> – If ‘eps’ is not in the valid range (0, 1).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.tv_dro.TVDRO.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.tv_dro.TVDRO.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the model using CVXPY to solve the robust optimization problem with TV constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Training feature matrix of shape <cite>(n_samples, n_features)</cite>.
Must satisfy <cite>n_features == self.input_dim</cite>.</p></li>
<li><p><strong>Y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – <p>Target values of shape <cite>(n_samples,)</cite>. Format requirements:</p>
<ul>
<li><p>Classification: ±1 labels</p></li>
<li><p>Regression: Continuous values</p></li>
</ul>
</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing trained parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">theta</span></code>: Weight vector of shape <cite>(n_features,)</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">threshold</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
</dl>
<p>.raises: TVDROError: If the optimization problem fails to solve.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.tv_dro.TVDRO.worst_distribution">
<span class="sig-name descname"><span class="pre">worst_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.tv_dro.TVDRO.worst_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the worst-case distribution based on TV constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Feature matrix of shape <cite>(n_samples, n_features)</cite>. 
Must match the model’s <cite>input_dim</cite> (n_features).</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Target vector of shape <cite>(n_samples,)</cite>. For regression tasks, continuous values 
are expected; for classification, ±1 labels.</p></li>
<li><p><strong>precision</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sample_pts</span></code>: Original data points as a tuple <code class="docutils literal notranslate"><span class="pre">(X,</span> <span class="pre">y)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight</span></code>: Worst-case probability weights of shape <cite>(n_samples,)</cite></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
</dl>
<p>.raises: TVDROError: If the worst-case distribution calculation fails.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-dro.src.linear_model.conditional_dro"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.linear_model.conditional_dro.ConditionalCVaRDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.linear_model.conditional_dro.</span></span><span class="sig-name descname"><span class="pre">ConditionalCVaRDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOSEK'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.conditional_dro.ConditionalCVaRDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO" title="dro.src.linear_model.base.BaseLinearDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLinearDRO</span></code></a></p>
<p>Y|X (ConditionalShiftBased) Conditional Value-at-Risk (Conditional-CVaR) Distributionally Robust Optimization (DRO) model that only allow likelihood ratio changes in Y|X.</p>
<p>This model minimizes a robust loss function for both regression and classification tasks
under a CVaR constraint only for the distribution of Y|X.</p>
<p>Conditional CVaR DRO model following Theorem 2 in:
with alpha(x) to be beta^T x for simplicity
alpha corresponds to Gamma in the paper.</p>
<p>Reference: &lt;<a class="reference external" href="https://arxiv.org/pdf/2209.01754.pdf">https://arxiv.org/pdf/2209.01754.pdf</a>&gt;</p>
<p>Initialize the linear DRO model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of input features. Must be ≥ 1.</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Type of base model. Valid options: 
‘svm’, ‘logistic’, ‘ols’, ‘lad’. Defaults to ‘svm’.</p></li>
<li><p><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to learn an intercept term. 
Set False for pre-centered data. Defaults to True.</p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Optimization solver. 
See class-level documentation for recommended options. Defaults to ‘MOSEK’.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">input_dim</span></code> &lt; 1</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">model_type</span></code> is not in [‘svm’, ‘logistic’, ‘ols’, ‘lad’]</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ConditionalCVaRDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;logistic&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">model_type</span><span class="p">)</span>
<span class="go">&#39;logistic&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>
<span class="go">1.0</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.conditional_dro.ConditionalCVaRDRO.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.conditional_dro.ConditionalCVaRDRO.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update Conditional CVaR-DRO model configuration.</p>
<p>Modifies control features and risk sensitivity parameters dynamically. 
Changes affect subsequent optimization but require manual re-fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – <p>Dictionary of configuration updates. Valid keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">control_name</span></code>: Indices of controlled features (0 ≤ index &lt; input_dim)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alpha</span></code>: Risk level for CVaR constraint (0 &lt; alpha ≤ 1)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ConditionalCVaRDROError</strong> – <ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">control_name</span></code> contains invalid indices</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is outside (0, 1]</p></li>
<li><p>If unrecognized configuration keys are provided</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<p>Control Features:</p>
<blockquote>
<div><ul class="simple">
<li><p>Controlled features (<code class="docutils literal notranslate"><span class="pre">control_name</span></code>) are protected from distribution shifts</p></li>
<li><p>Indices must satisfy: <span class="math notranslate nohighlight">\(0 \leq \text{index} &lt; \text{input_dim}\)</span></p></li>
</ul>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ConditionalCVaRDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;control_name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>  <span class="c1"># Protect 1st and 3rd features</span>
<span class="gp">... </span>    <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.95</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;control_name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">]})</span>  <span class="c1"># Invalid index for input_dim=5</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">ConditionalCVaRDROError</span>: <span class="n">All indices in &#39;control_name&#39; must be in [0, input_dim - 1]</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Setting <code class="docutils literal notranslate"><span class="pre">control_name=None</span></code> disables feature protection</p></li>
<li><p>Lower <code class="docutils literal notranslate"><span class="pre">alpha</span></code> values reduce conservatism (focus on average risk)</p></li>
<li><p>Configuration changes invalidate previous solutions (requires re-fitting)</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.conditional_dro.ConditionalCVaRDRO.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.conditional_dro.ConditionalCVaRDRO.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the Conditional CVaR-constrained DRO problem via convex optimization.</p>
<p>Constructs and optimizes a distributionally robust model that minimizes the 
worst-case conditional expected loss, where the ambiguity set is constrained 
by both CVaR and feature control parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Training feature matrix of shape <cite>(n_samples, n_features)</cite>. 
Must satisfy <cite>n_features == self.input_dim</cite>.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – <p>Target values of shape <cite>(n_samples,)</cite>. Format requirements:</p>
<ul>
<li><p>Classification: ±1 labels</p></li>
<li><p>Regression: Continuous values</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing trained parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">theta</span></code>: Weight vector of shape <cite>(n_features,)</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code>: Intercept term (exists if <cite>fit_intercept=True</cite>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cvar_threshold</span></code>: Optimal CVaR threshold value</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ConditionalCVaRDROError</strong> – <ul>
<li><p>If optimization fails (solver error/infeasible)</p></li>
<li><p>If <cite>X</cite> and control features have dimension mismatch</p></li>
</ul>
</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul>
<li><p>If <cite>X.shape[1] != self.input_dim</cite></p></li>
<li><p>If <cite>X.shape[0] != y.shape[0]</cite></p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Optimization Formulation:</dt><dd><div class="math notranslate nohighlight">
\[\min_{\theta,b} \ \sup_{Q \in \mathcal{Q}} \mathbb{E}_Q[\ell(\theta,b;X,y)]\]</div>
<p>where the ambiguity set <span class="math notranslate nohighlight">\(\mathcal{Q}\)</span> satisfies:</p>
<div class="math notranslate nohighlight">
\[\text{CVaR}_\alpha(\ell) \leq \tau \quad \text{and} \quad X_{\text{control}} = \mathbb{E}_P[X_{\text{control}}]\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(X_{\text{control}}\)</span> = features specified by <cite>control_name</cite></p></li>
<li><p><span class="math notranslate nohighlight">\(\tau\)</span> = CVaR threshold (optimization variable)</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ConditionalCVaRDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">control_name</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">5</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s2">&quot;b&quot;</span> <span class="ow">in</span> <span class="n">params</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CVaR threshold: </span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;cvar_threshold&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Controlled features (<code class="docutils literal notranslate"><span class="pre">control_name</span></code>) are assumed fixed under distribution shifts</p></li>
<li><p>Solution cache is invalidated after calling <a class="reference internal" href="#dro.src.linear_model.conditional_dro.ConditionalCVaRDRO.update" title="dro.src.linear_model.conditional_dro.ConditionalCVaRDRO.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a></p></li>
</ul>
</div>
</dd></dl>

</dd></dl>

<span class="target" id="module-dro.src.linear_model.hr_dro"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.linear_model.hr_dro.HR_DRO_LR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.linear_model.hr_dro.</span></span><span class="sig-name descname"><span class="pre">HR_DRO_LR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOSEK'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon_prime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.hr_dro.HR_DRO_LR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO" title="dro.src.linear_model.base.BaseLinearDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLinearDRO</span></code></a></p>
<p>Holistic Robust DRO Linear Regression (HR_DRO_LR) model.</p>
<p>This model supports HR DRO with additional robustness constraints for linear regression and binary classification. (Theorem 7)</p>
<p>Reference: &lt;<a class="reference external" href="https://arxiv.org/abs/2207.09560">https://arxiv.org/abs/2207.09560</a>&gt;</p>
<p>Initialize advanced DRO model with dual robustness parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of input features. Must be ≥ 1.</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Base model type. Defaults to ‘svm’.</p></li>
<li><p><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to fit intercept term. Defaults to True.</p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Optimization solver. Defaults to ‘MOSEK’.</p></li>
<li><p><strong>r</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Ambiguity set curvature parameter. Must satisfy r ≥ 0. Defaults to 1.0.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Risk level parameter. Must satisfy 0 &lt; alpha ≤ 1. Defaults to 1.0.</p></li>
<li><p><strong>epsilon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Wasserstein radius for distribution shifts. Must be ≥ 0. Defaults to 0.5.</p></li>
<li><p><strong>epsilon_prime</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Robustness budget for moment constraints. Must be ≥ 0. Defaults to 1.0.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If any parameter violates numerical constraints (r &lt; 0, alpha ∉ (0,1], etc.)</p></li>
<li><p>If model_type is not in allowed set</p></li>
<li><p>If input_dim &lt; 1</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">HR_DRO_LR</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> 
<span class="gp">... </span>    <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;logistic&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">r</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
<span class="gp">... </span>    <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">epsilon_prime</span><span class="o">=</span><span class="mf">0.8</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">epsilon_prime</span><span class="p">)</span>
<span class="go">0.5 0.8</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.hr_dro.HR_DRO_LR.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.hr_dro.HR_DRO_LR.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Dynamically update robustness parameters of the Advanced DRO model.</p>
<p>Modifies multi-level ambiguity set parameters while preserving existing model state.
Changes require manual re-fitting to take effect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – <p>Dictionary containing parameter updates. Supported keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code>: Curvature parameter for ambiguity set (must be ≥ 0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alpha</span></code>: Risk level for CVaR-like constraints (must satisfy 0 &lt; alpha ≤ 1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">epsilon</span></code>: Wasserstein radius for distribution shifts (must be ≥ 0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">epsilon_prime</span></code>: Moment constraint robustness budget (must be ≥ 0)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If any parameter violates numerical constraints</p></li>
<li><p>If invalid parameter types are provided</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<p>Parameter Relationships:</p>
<blockquote>
<div><ul class="simple">
<li><p>Larger <code class="docutils literal notranslate"><span class="pre">epsilon</span></code> allows more distribution shift</p></li>
<li><p>Higher <code class="docutils literal notranslate"><span class="pre">r</span></code> creates more conservative ambiguity set geometries</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">epsilon_prime</span></code> controls second-order moment robustness</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">HR_DRO_LR</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">})</span>  <span class="c1"># Valid update</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">})</span>  <span class="c1"># Invalid alpha</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">alpha must be in (0, 1], got 1.5</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Empty config dictionary will preserve current parameters</p></li>
<li><p>Partial updates are allowed (only modify specified parameters)</p></li>
<li><p>Always validate parameters before optimization phase</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.hr_dro.HR_DRO_LR.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.hr_dro.HR_DRO_LR.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the dual-ambiguity DRO problem via convex optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Training feature matrix of shape <cite>(n_samples, n_features)</cite>.
Must satisfy <cite>n_features == self.input_dim</cite>.</p></li>
<li><p><strong>Y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – <p>Target values of shape <cite>(n_samples,)</cite>. Format requirements:</p>
<ul>
<li><p>Classification: ±1 labels</p></li>
<li><p>Regression: Continuous values</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing trained parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">theta</span></code>: Weight vector of shape <cite>(n_features,)</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code>: Intercept term (if <cite>fit_intercept=True</cite>)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>HRDROError</strong> – <ul>
<li><p>If optimization fails due to solver errors</p></li>
<li><p>If problem becomes infeasible with current parameters</p></li>
</ul>
</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul>
<li><p>If <cite>X.shape[1] != self.input_dim</cite></p></li>
<li><p>If <cite>X.shape[0] != Y.shape[0]</cite></p></li>
<li><p>If parameters violate <cite>r ≥ 0</cite>, <cite>epsilon ≥ 0</cite>, etc.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Optimization Formulation:</dt><dd><div class="math notranslate nohighlight">
\[\min_{\theta,b} \sup_{Q \in \mathcal{Q}} \mathbb{E}_Q[\ell(\theta,b;X,Y)]\]</div>
<p>where the ambiguity set <span class="math notranslate nohighlight">\(\mathcal{Q}\)</span> satisfies:</p>
<div class="math notranslate nohighlight">
\[W(P,Q) \leq \epsilon \]</div>
<div class="math notranslate nohighlight">
\[\text{CVaR}_\alpha(\ell) \leq \tau + r\epsilon' \]</div>
<div class="math notranslate nohighlight">
\[\mathbb{E}_Q[\phi(X)] \leq \mathbb{E}_P[\phi(X)] + \epsilon'\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(W(P,Q)\)</span> = Wasserstein distance between distributions</p></li>
<li><p><span class="math notranslate nohighlight">\(r\)</span> = curvature parameter from <cite>self.r</cite></p></li>
<li><p><span class="math notranslate nohighlight">\(\phi(\cdot)\)</span> = moment constraint function</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">HR_DRO_LR</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>  <span class="c1"># Binary labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (3,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dual_vars&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="p">)</span>  <span class="c1"># True</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Solution time grows cubically with <cite>n_samples</cite></p></li>
<li><p>Set <cite>epsilon=0</cite> to disable Wasserstein constraints</p></li>
</ul>
</div>
</dd></dl>

</dd></dl>

<span class="target" id="module-dro.src.linear_model.marginal_dro"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.linear_model.marginal_dro.MarginalCVaRDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.linear_model.marginal_dro.</span></span><span class="sig-name descname"><span class="pre">MarginalCVaRDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOSEK'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.marginal_dro.MarginalCVaRDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO" title="dro.src.linear_model.base.BaseLinearDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLinearDRO</span></code></a></p>
<p>Marginal-X Conditional Value-at-Risk (Conditional-CVaR) Distributionally Robust Optimization (DRO) model that only allow likelihood ratio changes in X.</p>
<p>This model minimizes a robust loss function for both regression and classification tasks
under a CVaR constraint only for the marginal distribution of X.</p>
<p>Reference:
[1] &lt;<a class="reference external" href="https://pubsonline.informs.org/doi/10.1287/opre.2022.2363">https://pubsonline.informs.org/doi/10.1287/opre.2022.2363</a>&gt;
[2] The specific model follows Equation (27) in:
<a class="reference external" href="https://arxiv.org/pdf/2007.13982.pdf">https://arxiv.org/pdf/2007.13982.pdf</a> with parameters L and p.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimension of input features. Must be ≥ 1.</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Base model type. Defaults to ‘svm’. Valid options:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'svm'</span></code>: Support Vector Machine (hinge loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'logistic'</span></code>: Logistic Regression (log loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ols'</span></code>: Ordinary Least Squares (L2 loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lad'</span></code>: Least Absolute Deviation (L1 loss)</p></li>
</ul>
</p></li>
<li><p><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to learn intercept term <span class="math notranslate nohighlight">\(b\)</span>. 
Set False for pre-centered data. Defaults to True.</p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Convex optimization solver. Defaults to ‘MOSEK’.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – CVaR risk level controlling tail expectation. 
Must satisfy 0 &lt; α ≤ 1. 
Defaults to 1.0.</p></li>
<li><p><strong>L</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Wasserstein radius scaling factor. 
Larger values increase distributional robustness. Must satisfy L ≥ 0.
Defaults to 10.0.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Order of Wasserstein distance. 
Supported values: 1 (Earth Mover’s Distance) or 2 (Quadratic Wasserstein).
Defaults to 2.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If input_dim &lt; 1</p></li>
<li><p>If model_type not in allowed set</p></li>
<li><p>If alpha ∉ (0, 1]</p></li>
<li><p>If L &lt; 0</p></li>
<li><p>If p &lt; 1</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MarginalCVaRDRO</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> 
<span class="gp">... </span>    <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;lad&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">L</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">p</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">L</span>  <span class="c1"># 5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">p</span>  <span class="c1"># 1</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.marginal_dro.MarginalCVaRDRO.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.marginal_dro.MarginalCVaRDRO.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update Marginal CVaR-DRO model configuration parameters.</p>
<p>Dynamically adjusts the robustness parameters for marginal distribution shifts. 
Preserves existing solutions until next <code class="docutils literal notranslate"><span class="pre">fit()</span></code> call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – <p>Configuration dictionary with optional keys:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">control_name</span></code> (List[int]): </dt><dd><p>Indices of features to protect against marginal shifts. Constraints:</p>
<ul>
<li><p>All indices must satisfy <span class="math notranslate nohighlight">\(0 \leq \text{index} &lt; \text{input_dim}\)</span></p></li>
<li><p>Empty list disables marginal robustness</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">L</span></code> (float): </dt><dd><p>Wasserstein radius scaling factor. Must satisfy <span class="math notranslate nohighlight">\(L &gt; 0\)</span>
Larger values increase conservativeness</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">p</span></code> (int): </dt><dd><p>Wasserstein metric order. Must satisfy <span class="math notranslate nohighlight">\(p \geq 1\)</span>
Supported values: 1 (EMD), 2 (Quadratic)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">alpha</span></code> (float): </dt><dd><p>CVaR risk level. Must satisfy <span class="math notranslate nohighlight">\(0 &lt; \alpha \leq 1\)</span>
<span class="math notranslate nohighlight">\(\alpha \to 0\)</span> focuses on average loss, <span class="math notranslate nohighlight">\(\alpha = 1\)</span> is worst-case</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>MarginalCVaRDROError</strong> – <ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">control_name</span></code> contains invalid indices</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">L</span></code> is non-positive</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">p</span></code> &lt; 1</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">alpha</span></code> ∉ (0, 1]</p></li>
<li><p>If config contains unsupported keys</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MarginalCVaRDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">control_name</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="mf">15.0</span><span class="p">,</span>      
<span class="gp">... </span>    <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.95</span>  
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">L</span>  <span class="c1"># 15.0</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.marginal_dro.MarginalCVaRDRO.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.marginal_dro.MarginalCVaRDRO.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the Marginal CVaR-DRO problem via convex optimization.</p>
<p>Constructs and solves the following distributionally robust optimization problem:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Training feature matrix of shape <cite>(n_samples, n_features)</cite>.
Must satisfy <cite>n_features == self.input_dim</cite>.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – <p>Target vector of shape <cite>(n_samples,)</cite>. Format requirements depend on model_type:</p>
<ul>
<li><p>Classification (<cite>svm</cite>/<cite>logistic</cite>):</p>
<blockquote>
<div><ul class="simple">
<li><p>Binary labels in {-1, +1}</p></li>
<li><p>No missing values allowed</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Regression** (<cite>ols</cite>/<cite>lad</cite>):</p>
<blockquote>
<div><ul class="simple">
<li><p>Continuous real values</p></li>
<li><p>May contain NaN</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Solution dictionary containing:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">theta</span></code>: Weight vector of shape <cite>(n_features,)</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code>: Intercept term (exists if <cite>fit_intercept=True</cite>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code>: Marginal robustness dual matrix of shape <cite>(n_samples, n_samples)</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">threshold</span></code>: CVaR threshold value</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>MarginalCVaRDROError</strong> – <ul class="simple">
<li><p>If <cite>X.shape[1] != self.input_dim</cite></p></li>
<li><p>If <cite>X.shape[0] != y.shape[0]</cite></p></li>
<li><p>If optimization fails (problem infeasible/solver error)</p></li>
<li><p>If <cite>control_name</cite> indices exceed feature dimensions</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MarginalCVaRDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">control_name</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">L</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">sol</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (3,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>      <span class="c1"># (2, 2)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-dro.src.linear_model.mmd_dro"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.linear_model.mmd_dro.MMD_DRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.linear_model.mmd_dro.</span></span><span class="sig-name descname"><span class="pre">MMD_DRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bound'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.mmd_dro.MMD_DRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO" title="dro.src.linear_model.base.BaseLinearDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLinearDRO</span></code></a></p>
<p>MMD-DRO (Maximum Mean Discrepancy - Distributionally Robust Optimization)
Implementation with flexible sampling methods and model types.</p>
<p>Reference: &lt;<a class="reference external" href="https://arxiv.org/abs/2006.06981">https://arxiv.org/abs/2006.06981</a>&gt;</p>
<p>Initialize MMD-DRO with kernel-based ambiguity set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimension of input features. Must match training data.</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Base model type. Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'svm'</span></code>: Support Vector Machine (hinge loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'logistic'</span></code>: Logistic Regression (log loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ols'</span></code>: Ordinary Least Squares (L2 loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lad'</span></code>: Least Absolute Deviation (L1 loss)</p></li>
</ul>
</p></li>
<li><p><strong>sampling_method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'bound'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'hull'</span></code></p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If <cite>model_type</cite> not in supported list</p></li>
<li><p>If <cite>input_dim</cite> ≤ 0</p></li>
<li><p>If <cite>sampling_method</cite> is invalid</p></li>
<li><p>If <cite>n_certify_ratio</cite> &lt; 1</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MMD_DRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">sampling_method</span> <span class="o">=</span> <span class="s1">&#39;hull&#39;</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">eta</span> <span class="o">=</span> <span class="mf">0.5</span>  
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.mmd_dro.MMD_DRO.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.mmd_dro.MMD_DRO.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update MMD-DRO model configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – <p>Configuration dictionary containing optional keys:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">eta</span></code> (float): </dt><dd><p>MMD radius controlling distributional robustness. 
Must satisfy <span class="math notranslate nohighlight">\(\eta &gt; 0\)</span>.
Defaults to current value.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">sampling_method</span></code> (str): </dt><dd><p>Ambiguity set sampling strategy. Valid options:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'bound'</span></code>: Sample on MMD ball boundary</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'hull'</span></code>: Sample within convex hull</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">n_certify_ratio</span></code> (float): </dt><dd><p>Ratio of certification samples to training data size. 
Must satisfy <span class="math notranslate nohighlight">\(0 &lt;         ext{ratio} \leq 1\)</span>.
Defaults to current ratio.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">eta</span></code> is non-positive</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">sampling_method</span></code> not in {‘bound’, ‘hull’}</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">n_certify_ratio</span></code> ∉ (0, 1]</p></li>
<li><p>If config contains unrecognized keys</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MMD_DRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>              
<span class="gp">... </span>    <span class="s1">&#39;sampling_method&#39;</span><span class="p">:</span> <span class="s1">&#39;hull&#39;</span> 
<span class="gp">... </span><span class="p">})</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.mmd_dro.MMD_DRO.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.mmd_dro.MMD_DRO.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the MMD-DRO model to the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Training feature matrix of shape <cite>(n_samples, n_features)</cite>.
Must satisfy <cite>n_features == self.input_dim</cite>.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – <p>Target values of shape <cite>(n_samples,)</cite>. Format requirements:</p>
<ul>
<li><p>Classification: ±1 labels</p></li>
<li><p>Regression: Continuous values</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing trained parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">theta</span></code>: Weight vector of shape <cite>(n_features,)</cite></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-dro.src.linear_model.mot_dro"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.linear_model.mot_dro.MOTDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.linear_model.mot_dro.</span></span><span class="sig-name descname"><span class="pre">MOTDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOSEK'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.mot_dro.MOTDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO" title="dro.src.linear_model.base.BaseLinearDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLinearDRO</span></code></a></p>
<p>Optimal Transport DRO with Conditional Moment Constraints.</p>
<p>Implements DRO with composite transportation cost:</p>
<div class="math notranslate nohighlight">
\[c\big(((X_1,Y_1),w), ((X_2,Y_2),\hat{w})\big) = \theta_1 w \cdot d((X_1,Y_1),(X_2,Y_2)) 
 + \theta_2 (\phi(w) - \phi(\hat{w}))^+\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi(\cdot)\)</span> is the KL divergence.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Wasserstein distance scaling factor (<span class="math notranslate nohighlight">\(\theta_1 \geq 0\)</span>)</p></li>
<li><p><strong>theta2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – KL divergence penalty coefficient (<span class="math notranslate nohighlight">\(\theta_2 \geq 0\)</span>)</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Robustness radius for OT ambiguity set (<span class="math notranslate nohighlight">\(\epsilon \geq 0\)</span>)</p></li>
<li><p><strong>p</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – Norm order for feature perturbation. Valid values: 2 (L2), ‘inf’ (L_inf)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
<li><p><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – </p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – </p></li>
</ul>
</dd>
</dl>
<p>Initialize MOT-DRO with restricted model types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimension of input features. Must be ≥ 1.</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Base model type. Defaults to ‘svm’. Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'svm'</span></code>: Support Vector Machine (hinge loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lad'</span></code>: Least Absolute Deviation (L1 loss)</p></li>
</ul>
</p></li>
<li><p><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to learn intercept term. 
Set False for pre-centered data. Defaults to True.</p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Convex optimization solver. Defaults to ‘MOSEK’.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>MOTDROError</strong> – <ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">model_type</span></code> in [‘ols’, ‘logistic’]</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">input_dim</span></code> &lt; 1</p></li>
</ul>
</p>
</dd>
</dl>
<p>Default Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">theta1</span></code>: 1.0 (minimum Wasserstein scaling)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">square</span></code>: 2.0 (quadratic regularization strength)</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MOTDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">theta1</span> <span class="o">=</span> <span class="mf">1.5</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">square</span> <span class="o">=</span> <span class="mf">1.0</span>  
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.mot_dro.MOTDRO.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.mot_dro.MOTDRO.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update MOTDRO model configuration with coupled parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – <p>Dictionary containing parameters to update. Valid keys:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">theta1</span></code> (float &gt; 1): </dt><dd><p>Wasserstein distance scaling factor. Updates trigger:
<span class="math notranslate nohighlight">\(\theta_2 = \frac{1}{1 - 1/\theta_1}\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">theta2</span></code> (float &gt; 1): </dt><dd><p>KL divergence penalty coefficient. Updates trigger:
<span class="math notranslate nohighlight">\(\theta_1 = \frac{1}{1 - 1/\theta_2}\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">eps</span></code> (float ≥ 0): </dt><dd><p>Robustness radius for OT ambiguity set</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">p</span></code> (float ≥1 or ‘inf’): </dt><dd><p>Perturbation norm order (1 ≤ p ≤ ∞)</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>MOTDROError</strong> – <ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">theta1</span></code> ≤ 1 or <code class="docutils literal notranslate"><span class="pre">theta2</span></code> ≤ 1</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">theta1</span></code>/<code class="docutils literal notranslate"><span class="pre">theta2</span></code> relationship becomes invalid</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">eps</span></code> &lt; 0 or non-numeric</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">p</span></code> &lt; 1 (when numeric) or not ‘inf’</p></li>
<li><p>If parameter types are incorrect</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<dl>
<dt>Parameter Coupling:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt><span class="math notranslate nohighlight">\(\theta_1\)</span> and <span class="math notranslate nohighlight">\(\theta_2\)</span> are related through:</dt><dd><p><span class="math notranslate nohighlight">\(\theta_1 = \frac{1}{1 - 1/\theta_2}\)</span></p>
</dd>
</dl>
</li>
<li><p>Updating one automatically adjusts the other</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;theta1&#39;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span>       
<span class="gp">... </span>    <span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="s1">&#39;inf&#39;</span><span class="p">,</span>          
<span class="gp">... </span>    <span class="s1">&#39;eps&#39;</span><span class="p">:</span> <span class="mf">0.3</span>           
<span class="gp">... </span><span class="p">})</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.mot_dro.MOTDRO.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.mot_dro.MOTDRO.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the MMD-DRO model to the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Training feature matrix of shape <cite>(n_samples, n_features)</cite>.
Must satisfy <cite>n_features == self.input_dim</cite>.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – <p>Target values of shape <cite>(n_samples,)</cite>. Format requirements:</p>
<ul>
<li><p>Classification: ±1 labels</p></li>
<li><p>Regression: Continuous values</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing trained parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">theta</span></code>: Weight vector of shape <cite>(n_features,)</cite></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-dro.src.linear_model.or_wasserstein_dro"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.linear_model.or_wasserstein_dro.ORWDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.linear_model.or_wasserstein_dro.</span></span><span class="sig-name descname"><span class="pre">ORWDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dual_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.or_wasserstein_dro.ORWDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO" title="dro.src.linear_model.base.BaseLinearDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLinearDRO</span></code></a></p>
<p>Outlier-Robust Wasserstein Distributionally Robust Optimization (OR-WDRO) model.</p>
<p>Implements TV-corrupted p-Wasserstein DRO with dual norm constraints:</p>
<div class="math notranslate nohighlight">
\[\min_{\theta} \sup_{Q \in \mathcal{B}_\epsilon(P)} \mathbb{E}_Q[\ell(\theta;X,y)]
+ \eta \cdot \text{TV}(P,Q)\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{B}_\epsilon(P)\)</span> is the Wasserstein ball and <span class="math notranslate nohighlight">\(\text{TV}\)</span> is total variation.</p>
<p>ORWDRO_Paper: <a class="reference external" href="https://arxiv.org/pdf/2311.05573">https://arxiv.org/pdf/2311.05573</a></p>
<p>Initialize OR-WDRO model with anomaly-robust parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Feature space dimension. Must be ≥ 1</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Base learner type. Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'svm'</span></code>: Hinge loss (classification)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'logistic'</span></code>: Logistic loss (classification)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ols'</span></code>: Squared loss (regression)</p></li>
</ul>
</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – <p>Wasserstein robustness radius. Defaults to 0.0</p>
<ul>
<li><p>0: Standard empirical risk minimization</p></li>
<li><p>&gt;0: Controls distributional robustness</p></li>
</ul>
</p></li>
<li><p><strong>eta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Expected outlier fraction. 
Must satisfy <span class="math notranslate nohighlight">\(0 \leq \eta \leq 0.5\)</span>. Defaults to 0.0</p></li>
<li><p><strong>dual_norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – <p>Wasserstein dual norm order. Valid values:</p>
<ul>
<li><p>1: ℓ¹-Wasserstein (transportation cost)</p></li>
<li><p>2: ℓ²-Wasserstein (default)</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If input_dim &lt; 1</p></li>
<li><p>If model_type not in allowed set</p></li>
<li><p>If eps &lt; 0 or eta &lt; 0 or eta &gt; 0.5</p></li>
<li><p>If dual_norm ∉ {1, 2}</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ORWDRO</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">eps</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">eta</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dual_norm</span><span class="o">=</span><span class="mi">2</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">sigma</span>  <span class="c1"># sqrt(5) ≈ 2.236</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Computation complexity scales as <span class="math notranslate nohighlight">\(O(\epsilon^{-2})\)</span></p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">eta=0</span></code> to disable outlier robustness</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.or_wasserstein_dro.ORWDRO.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.or_wasserstein_dro.ORWDRO.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update robustness parameters for OR-WDRO optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – <p>Dictionary containing parameters to update. Valid keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'eps'</span></code>: New Wasserstein radius (ε ≥ 0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'eta'</span></code>: New outlier fraction (0 ≤ η ≤ 0.5)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'dual_norm'</span></code>: Norm order (1 or 2)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If parameter values violate type or range constraints</p></li>
<li><p>If unknown parameters are provided</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;eps&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;dual_norm&#39;</span><span class="p">:</span> <span class="mi">2</span>
<span class="gp">... </span><span class="p">})</span>  <span class="c1"># Updates multiple parameters atomically</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.or_wasserstein_dro.ORWDRO.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.or_wasserstein_dro.ORWDRO.fit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Training feature matrix of shape <cite>(n_samples, n_features)</cite>.
Must satisfy <cite>n_features == self.input_dim</cite>.</p></li>
<li><p><strong>Y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – <p>Target values of shape <cite>(n_samples,)</cite>. Format requirements:</p>
<ul>
<li><p>Classification: ±1 labels</p></li>
<li><p>Regression: Continuous values</p></li>
</ul>
</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing trained parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">theta</span></code>: Weight vector of shape <cite>(n_features,)</cite></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.or_wasserstein_dro.ORWDRO.worst_distribution">
<span class="sig-name descname"><span class="pre">worst_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.or_wasserstein_dro.ORWDRO.worst_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the worst-case distribution.</p>
<p>Reference: Theorem 3 in <a class="reference external" href="https://arxiv.org/pdf/2311.05573">https://arxiv.org/pdf/2311.05573</a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a>) – </p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>X (np.ndarray): Input feature matrix with shape (n_samples, n_features).
y (np.ndarray): Target vector with shape (n_samples,).</p>
</dd>
<dt>Returns:</dt><dd><p>Dict[str, Any]: Dictionary containing ‘sample_pts’ and ‘weight’ keys for worst-case distribution.</p>
</dd>
<dt>Raises:</dt><dd><p>ORWDROError: If the worst-case distribution optimization fails.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-dro.src.linear_model.sinkhorn_dro"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.linear_model.sinkhorn_dro.SinkhornLinearDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.linear_model.sinkhorn_dro.</span></span><span class="sig-name descname"><span class="pre">SinkhornLinearDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_sample_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.sinkhorn_dro.SinkhornLinearDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO" title="dro.src.linear_model.base.BaseLinearDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLinearDRO</span></code></a></p>
<p>Sinkhorn Distributionally Robust Optimization with Linear Models.</p>
<p>Reference: &lt;<a class="reference external" href="https://arxiv.org/abs/2109.11926">https://arxiv.org/abs/2109.11926</a>&gt;</p>
<p>Initialize Sinkhorn Distributionally Robust Optimization model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimension of input feature space (d)</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Base model architecture. Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'svm'</span></code>: Support Vector Machine (hinge loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'logistic'</span></code>: Logistic Regression (cross-entropy loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ols'</span></code>: Ordinary Least Squares (L2 loss)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lad'</span></code>: Least Absolute Deviation (L1 loss)</p></li>
</ul>
</p></li>
<li><p><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to learn bias term <span class="math notranslate nohighlight">\(b\)</span>. 
Disable for pre-centered data. Defaults to True.</p></li>
<li><p><strong>reg_param</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Entropic regularization strength <span class="math notranslate nohighlight">\(\epsilon\)</span> 
controlling transport smoothness. Must be &gt; 0. Defaults to 1e-3.</p></li>
<li><p><strong>lambda_param</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Loss scaling factor <span class="math notranslate nohighlight">\(\lambda\)</span> 
balancing Wasserstein distance and loss. Must be &gt; 0. Defaults to 1e2.</p></li>
<li><p><strong>output_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimension of model output. 
1 for regression/binary classification. Defaults to 1.</p></li>
<li><p><strong>max_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Maximum number of Sinkhorn iterations. 
Should be ≥ 100. Defaults to 1e3.</p></li>
<li><p><strong>learning_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Step size for gradient-based optimization. 
Typical range: [1e-4, 1e-1]. Defaults to 1e-2.</p></li>
<li><p><strong>k_sample_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Maximum level for Multilevel Monte Carlo sampling. 
Higher values improve accuracy but increase computation. Defaults to 5.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Computation device. 
Supported: <code class="docutils literal notranslate"><span class="pre">'cpu'</span></code> or <code class="docutils literal notranslate"><span class="pre">'cuda'</span></code>. Defaults to ‘cpu’.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If any parameter violates numerical constraints (ε ≤ 0, λ ≤ 0, etc.)</p></li>
<li><p>If model_type is not in supported set</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SinkhornDRO</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_dim</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">reg_param</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">lambda_param</span><span class="o">=</span><span class="mf">50.0</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>  <span class="c1"># &#39;cpu&#39;</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Setting <code class="docutils literal notranslate"><span class="pre">device='torch.device(cuda)'</span></code> requires PyTorch with GPU support (CUDA-enabled)</p></li>
<li><p>It is recommended to retain the default k_sample_max=5 to balance accuracy and computational efficiency</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.sinkhorn_dro.SinkhornLinearDRO.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.sinkhorn_dro.SinkhornLinearDRO.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update hyperparameters for Sinkhorn optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – <p>Dictionary containing parameter updates. Valid keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'reg'</span></code>: Entropic regularization strength (ε &gt; 0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lambda'</span></code>: Loss scaling factor (λ &gt; 0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'k_sample_max'</span></code>: Maximum MLMC sampling level (integer ≥ 1)</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If any parameter value violates type or range constraints</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;reg&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;lambda&#39;</span><span class="p">:</span> <span class="mf">50.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;k_sample_max&#39;</span><span class="p">:</span> <span class="mi">3</span>
<span class="gp">... </span><span class="p">})</span>  <span class="c1"># Explicit type conversion handled internally</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For GPU-accelerated computation, specify it during initialization instead of this function</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.sinkhorn_dro.SinkhornLinearDRO.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.sinkhorn_dro.SinkhornLinearDRO.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate predictions using the optimized Sinkhorn DRO model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Input feature matrix. Should have shape (n_samples, n_features)
where n_features must match model’s input dimension.
Supported dtype: float32/float64</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Model predictions. Shape depends on task:</p>
<ul class="simple">
<li><p>Regression: (n_samples, 1)</p></li>
<li><p>Classification: (n_samples,) with 0/1 labels</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If input dimension mismatch occurs (n_features != model_dim)</p></li>
<li><p>If input contains NaN/Inf values</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>  <span class="c1"># Shape: (10, 1) for regression</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Input data is automatically converted to PyTorch tensors</p></li>
<li><p>For large datasets (&gt;1M samples), use batch prediction</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.sinkhorn_dro.SinkhornLinearDRO.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.sinkhorn_dro.SinkhornLinearDRO.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate model performance on given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Input feature matrix. Shape: (n_samples, n_features)
Must match model’s expected input dimension</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – <p>Target values. Shape requirements:</p>
<ul>
<li><p>Regression: (n_samples,) or (n_samples, 1)</p></li>
<li><p>Classification: (n_samples,) with binary labels (0/1)</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Performance metrics:</p>
<ul class="simple">
<li><p>Regression: Mean Squared Error (MSE) as float</p></li>
<li><p>Classification: Tuple of (accuracy%, macro-F1 score) in [0,1] range</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>, Tuple[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>]]</p>
</dd>
</dl>
<dl>
<dt>Example:    </dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Regression</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_reg</span><span class="p">,</span> <span class="n">y_reg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SinkhornDRO</span><span class="p">(</span><span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;ols&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mse</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_reg</span><span class="p">,</span> <span class="n">y_reg</span><span class="p">)</span>  <span class="c1"># e.g. 0.153</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Classification  </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_clf</span><span class="p">,</span> <span class="n">y_clf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SinkhornDRO</span><span class="p">(</span><span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">acc</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_clf</span><span class="p">,</span> <span class="n">y_clf</span><span class="p">)</span>  <span class="c1"># e.g. (0.92, 0.89)</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>For regression tasks, outputs are not thresholded</p></li>
<li><p>Computation uses all available samples (no mini-batching)</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.sinkhorn_dro.SinkhornLinearDRO.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SG'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.sinkhorn_dro.SinkhornLinearDRO.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the Sinkhorn DRO model with specified optimization strategy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Training feature matrix. Shape: (n_samples, n_features)
Should match model’s input dimension (n_features == input_dim)</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – <p>Target values. Shape requirements:</p>
<ul>
<li><p>Regression: (n_samples,) continuous values</p></li>
<li><p>Classification: (n_samples,) binary labels (0/1)</p></li>
</ul>
</p></li>
<li><p><strong>optimization_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Optimization algorithm selection (Defaults to ‘SG’):</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'SG'</span></code>: Standard Stochastic Gradient (baseline)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'MLMC'</span></code>: Multilevel Monte Carlo acceleration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'RTMLMC'</span></code>: Real-Time MLMC with adaptive sampling</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Learned parameters containing:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'theta'</span></code>: Model coefficients (n_features,)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'bias'</span></code>: Intercept term (if fit_intercept=True)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If X/y have mismatched sample counts (n_samples)</p></li>
<li><p>If optimization_type not in {‘SG’, ‘MLMC’, ‘RTMLMC’}</p></li>
<li><p>If input_dim ≠ X.shape[1]</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SinkhornDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="s1">&#39;MLMC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">])</span>  <span class="c1"># [-0.12, 1.45, ...]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-dro.src.linear_model.wasserstein_dro"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.linear_model.wasserstein_dro.WassersteinDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.linear_model.wasserstein_dro.</span></span><span class="sig-name descname"><span class="pre">WassersteinDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOSEK'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.wasserstein_dro.WassersteinDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO" title="dro.src.linear_model.base.BaseLinearDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLinearDRO</span></code></a></p>
<p>Wasserstein Distributionally Robust Optimization (WDRO) model</p>
<p>This model minimizes a Wasserstein-robust loss function for both regression and classification.</p>
<p>The Wasserstein distance is defined as the minimum probability coupling of two distributions for the distance metric:</p>
<div class="math notranslate nohighlight">
\[d((X_1, Y_1), (X_2, Y_2)) = (\|\Sigma^{1/2} (X_1 - X_2)\|_p)^{square} + \kappa |Y_1 - Y_2|,\]</div>
<p>where parameters are:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Sigma\)</span>: cost matrix, (a PSD Matrix);</p></li>
<li><p><span class="math notranslate nohighlight">\(\kappa\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span>;</p></li>
<li><p>square (notation depending on the model type), where square = 2 for ‘svm’, ‘logistic’, ‘lad’; square = 1 for ‘ols’.</p></li>
</ul>
</div></blockquote>
<p>Reference:</p>
<p>[1] OLS: &lt;<a class="reference external" href="https://www.cambridge.org/core/journals/journal-of-applied-probability/article/robust-wasserstein-profile-inference-and-applications-to-machine-learning/4024D05DE4681E67334E45D039295527">https://www.cambridge.org/core/journals/journal-of-applied-probability/article/robust-wasserstein-profile-inference-and-applications-to-machine-learning/4024D05DE4681E67334E45D039295527</a>&gt;</p>
<p>[2] LAD / SVM / Logistic: &lt;<a class="reference external" href="https://jmlr.org/papers/volume20/17-633/17-633.pdf">https://jmlr.org/papers/volume20/17-633/17-633.pdf</a>&gt;</p>
<p>Initialize Mahalanobis-Wasserstein DRO model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimension of feature space. Must satisfy :math:`      ext{input_dim} geq 1`</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Base model architecture. Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'svm'</span></code>: Hinge loss (classification)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'logistic'</span></code>: Logistic loss (classification)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ols'</span></code>: Least squares (regression)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lad'</span></code>: Least absolute deviation (regression)</p></li>
</ul>
</p></li>
<li><p><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to learn intercept term <span class="math notranslate nohighlight">\(b\)</span>.
Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> for pre-centered data. Defaults to True.</p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Convex optimization solver. Valid options:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'MOSEK'</span></code> (commercial, recommended)</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If input_dim &lt; 1</p></li>
<li><p>If model_type not in allowed set</p></li>
<li><p>If unsupported solver is selected</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">WassersteinDRO</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;MOSEK&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">cost_matrix</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># (5, 5)</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Changing <code class="docutils literal notranslate"><span class="pre">cost_matrix</span></code> after initialization requires calling <code class="docutils literal notranslate"><span class="pre">update()</span></code></p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.wasserstein_dro.WassersteinDRO.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.wasserstein_dro.WassersteinDRO.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update Wasserstein-DRO model parameters dynamically.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – <p>Configuration dictionary with keys:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'cost_matrix'</span></code>: Mahalanobis metric matrix <span class="math notranslate nohighlight">\(\Sigma^{-1} \succ 0\)</span></p>
<blockquote>
<div><ul class="simple">
<li><p>Shape: (input_dim, input_dim)</p></li>
<li><p>Type: numpy.ndarray</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'eps'</span></code>: Wasserstein radius <span class="math notranslate nohighlight">\(\epsilon \geq 0\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'p'</span></code>: Wasserstein order <span class="math notranslate nohighlight">\(p \geq 1\)</span> or <code class="docutils literal notranslate"><span class="pre">'inf'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'kappa'</span></code>: Y-ambiguity radius <span class="math notranslate nohighlight">\(\kappa \geq 0\)</span> or <code class="docutils literal notranslate"><span class="pre">'inf'</span></code></p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul>
<li><p>If cost_matrix is not positive definite</p></li>
<li><p>If eps &lt; 0</p></li>
<li><p>If p &lt; 1 and p ≠ ‘inf’</p></li>
<li><p>If kappa &lt; 0 and kappa ≠ ‘inf’</p></li>
</ul>
</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – <ul>
<li><p>If cost_matrix is not numpy array</p></li>
<li><p>If numeric parameters are not float/int</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">WassersteinDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_config</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;eps&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;cost_matrix&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">p</span>  <span class="c1"># 2.0</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.wasserstein_dro.WassersteinDRO.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.wasserstein_dro.WassersteinDRO.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the model using CVXPY to solve the WDRO problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Training feature matrix of shape <cite>(n_samples, n_features)</cite>.
Must satisfy <cite>n_features == self.input_dim</cite>.</p></li>
<li><p><strong>Y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – <p>Target values of shape <cite>(n_samples,)</cite>. Format requirements:</p>
<ul>
<li><p>Classification: ±1 labels</p></li>
<li><p>Regression: Continuous values</p></li>
</ul>
</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing trained parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">theta</span></code>: Weight vector of shape <cite>(n_features,)</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
</dl>
<p>.raises: WassersteinDROError: If the optimization problem fails to solve.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.wasserstein_dro.WassersteinDRO.worst_distribution">
<span class="sig-name descname"><span class="pre">worst_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.wasserstein_dro.WassersteinDRO.worst_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute worst-case distribution under Wasserstein ambiguity set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Input feature matrix. Shape: (n_samples, n_features)
Must satisfy <code class="docutils literal notranslate"><span class="pre">n_features</span> <span class="pre">==</span> <span class="pre">input_dim</span></code></p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – <p>Target vector. Shape: (n_samples,)</p>
<ul>
<li><p>Classification: binary labels (-1/1)</p></li>
<li><p>Regression: continuous values</p></li>
</ul>
</p></li>
<li><p><strong>compute_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Computation methodology. Options:</p>
<ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'asymp'</span></code>: Asymptotic approximation (faster, less accurate)</dt><dd><p><em>Supported models</em>: <code class="docutils literal notranslate"><span class="pre">['svm',</span> <span class="pre">'logistic',</span> <span class="pre">'lad']</span></code></p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'exact'</span></code>: Exact dual solution (slower, precise)</p></li>
</ul>
</p></li>
<li><p><strong>gamma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Regularization parameter for asymptotic method. 
Must satisfy <span class="math notranslate nohighlight">\(\gamma &gt; 0\)</span> when <code class="docutils literal notranslate"><span class="pre">compute_type='asymp'</span></code>.
Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'sample_pts'</span></code>: Worst-case sample locations. Shape: (m, n_features)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'weights'</span></code>: Probability weights. Shape: (m,) with <span class="math notranslate nohighlight">\(\sum w_i = 1\)</span></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Any]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">compute_type='asymp'</span></code> with <code class="docutils literal notranslate"><span class="pre">model_type='ols'</span></code></p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">compute_type='asymp'</span></code> and <code class="docutils literal notranslate"><span class="pre">kappa</span> <span class="pre">==</span> <span class="pre">'inf'</span></code></p></li>
<li><p>If gamma ≤ 0 when required</p></li>
</ul>
</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – <ul>
<li><p>If input dimensions mismatch</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">WassersteinDRO</span><span class="p">(</span><span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wc_dist</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">worst_distribution</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;asymp&#39;</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wc_dist</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Approximately 1.0</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Asymptotic method ignores curvature regularization (κ=infty)</p></li>
<li><p>Exact method requires <code class="docutils literal notranslate"><span class="pre">solver='MOSEK'</span></code> for conic constraints</p></li>
</ul>
</div>
<p>Reference of Worst-case Distribution:</p>
<p>[1] SVM / Logistic / LAD: Theorem 20 (ii) in <a class="reference external" href="https://jmlr.org/papers/volume20/17-633/17-633.pdf">https://jmlr.org/papers/volume20/17-633/17-633.pdf</a>, where eta is the theta in eq(27) and gamma = 0 in that equation.</p>
<p>[2] In all cases, we use a reduced dual case (e.g., Remark 5.2 of <a class="reference external" href="https://arxiv.org/pdf/2308.05414">https://arxiv.org/pdf/2308.05414</a>) to compute their worst-case distribution.</p>
<p>[3] General Worst-case Distributions can be found in: <a class="reference external" href="https://pubsonline.informs.org/doi/abs/10.1287/moor.2022.1275">https://pubsonline.informs.org/doi/abs/10.1287/moor.2022.1275</a>, where norm_theta is lambda* here.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.linear_model.wasserstein_dro.</span></span><span class="sig-name descname"><span class="pre">WassersteinDROsatisficing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOSEK'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO" title="dro.src.linear_model.base.BaseLinearDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLinearDRO</span></code></a></p>
<p>Robust satisficing version of Wasserstein DRO</p>
<p>This model minimizes the subject to (approximated version) of the robust satisficing constraint of Wasserstein DRO. The Wasserstein Distance is defined as the minimum probability coupling of two distributions for the distance metric:</p>
<div class="math notranslate nohighlight">
\[d((X_1, Y_1), (X_2, Y_2)) = (\|\Sigma^{1/2} (X_1 - X_2)\|_p)^{square} + \kappa |Y_1 - Y_2|,\]</div>
<p>Reference: &lt;<a class="reference external" href="https://pubsonline.informs.org/doi/10.1287/opre.2021.2238">https://pubsonline.informs.org/doi/10.1287/opre.2021.2238</a>&gt;</p>
<p>Initialize Robust satisficing version of Wasserstein DRO.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Feature space dimension. Must satisfy <span class="math notranslate nohighlight">\(d \geq 1\)</span></p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Base model architecture. Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'svm'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'logistic'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ols'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lad'</span></code></p></li>
</ul>
</p></li>
<li><p><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to learn intercept <span class="math notranslate nohighlight">\(b\)</span>.
Disable for standardized data. Defaults to True.</p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Convex optimization solver. Options:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'MOSEK'</span></code> (commercial, recommended)</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If input_dim &lt; 1</p></li>
<li><p>If model_type not in allowed set</p></li>
<li><p>If invalid solver selected</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Initialization Defaults:</dt><dd><ol class="arabic simple">
<li><p>Cost matrix initialized as identity <span class="math notranslate nohighlight">\(I_d\)</span></p></li>
<li><p>Target ratio :math:`     au = 1/0.8` (20% performance margin)</p></li>
<li><p>Wasserstein order <span class="math notranslate nohighlight">\(p=1\)</span> (earth mover’s distance)</p></li>
</ol>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">WassersteinDROsatisficing</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;ECOS&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">cost_matrix</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># (5, 5)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update model parameters based on configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – The model configuration</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit model to data by solving an optimization problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – input covariates</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – input labels</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing.fit_depreciate">
<span class="sig-name descname"><span class="pre">fit_depreciate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing.fit_depreciate" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the best epsilon that matches the desired robust objective via bisection (depreciated)</p>
<dl>
<dt>Args:</dt><dd><p>X (np.ndarray): Input feature matrix with shape (n_samples, n_features).</p>
<p>y (np.ndarray): Target vector with shape (n_samples,).</p>
</dd>
<dt>Returns:</dt><dd><p>Dict[str, Any]: Model parameters dictionary with ‘theta’ key.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing.fit_oracle">
<span class="sig-name descname"><span class="pre">fit_oracle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing.fit_oracle" title="Permalink to this definition">¶</a></dt>
<dd><p>Depreciated, find the optimal thet given the ambiguity constraint.</p>
<dl>
<dt>Args:</dt><dd><p>X (np.ndarray): Input feature matrix with shape (n_samples, n_features).</p>
<p>y (np.ndarray): Target vector with shape (n_samples,).</p>
</dd>
<dt>Returns:</dt><dd><p>float: robust objective value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing.worst_distribution">
<span class="sig-name descname"><span class="pre">worst_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing.worst_distribution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<span class="target" id="module-dro.src.linear_model.bayesian_dro"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.linear_model.bayesian_dro.BayesianDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.linear_model.bayesian_dro.</span></span><span class="sig-name descname"><span class="pre">BayesianDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'svm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOSEK'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'KL'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.bayesian_dro.BayesianDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO" title="dro.src.linear_model.base.BaseLinearDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLinearDRO</span></code></a></p>
<p>This model minimizes a Bayesian version for regression and other types of losses</p>
<p>Reference: &lt;<a class="reference external" href="https://epubs.siam.org/doi/10.1137/21M1465548">https://epubs.siam.org/doi/10.1137/21M1465548</a>&gt;</p>
<p>Initialize the Bayesian DRO model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimensionality of the input features.</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Type of base model. Supported values: ‘svm’, ‘logistic’, ‘ols’, ‘lad’(‘svm’ for SVM, ‘logistic’ for Logistic Regression, ‘ols’ for Linear Regression with L2-loss, ‘lad’ for Linear Regression with L1-loss). Defaults to ‘svm’.</p></li>
<li><p><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to fit an intercept term. If set to False, no intercept will be used in calculations (i.e. data is expected to be centered). Defaults to True.</p></li>
<li><p><strong>solver</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Optimization solver. Supported solvers: ‘MOSEK’.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Robustness parameter for KL-divergence ambiguity set. A higher value increases robustness. Defaults to 0.0 (non-robust).</p></li>
<li><p><strong>distance_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Distance type in DRO model, default = ‘KL’. Also support ‘chi2’. Default to ‘KL’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.bayesian_dro.BayesianDRO.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.bayesian_dro.BayesianDRO.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the model configuration dynamically.</p>
<p>Modify parameters like robustness level (<cite>eps</cite>), optimization solver, distance metric type, 
or other algorithm settings during runtime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – <p>Dictionary containing configuration key-value pairs to update. Supported keys include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">eps</span></code>: Robustness parameter (non-negative float)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solver</span></code>: Optimization solver (e.g., ‘MOSEK’, ‘SCS’)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distance_type</span></code>: Distance metric (‘KL’ or ‘chi2’)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distribution_class</span></code>: Distribution class</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">posterior_sample_ratio</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">posterior_param_num</span></code></p></li>
<li><p>Other model-specific parameters</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the configuration contains invalid keys, unsupported values, 
or negative values for parameters like <code class="docutils literal notranslate"><span class="pre">eps</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Updating some parameters (e.g., <code class="docutils literal notranslate"><span class="pre">solver</span></code>) may trigger reinitialization of the optimizer.</p></li>
<li><p>For safety, avoid modifying <code class="docutils literal notranslate"><span class="pre">input_dim</span></code> or <code class="docutils literal notranslate"><span class="pre">model_type</span></code> after initialization.</p></li>
</ul>
</div>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;eps&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;distance_type&quot;</span><span class="p">:</span> <span class="s2">&quot;chi2&quot;</span><span class="p">,</span> <span class="s2">&quot;solver&quot;</span><span class="p">:</span> <span class="s2">&quot;MOSEK&quot;</span><span class="p">})</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.bayesian_dro.BayesianDRO.resample">
<span class="sig-name descname"><span class="pre">resample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.bayesian_dro.BayesianDRO.resample" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate resampled data based on posterior parameters.</p>
<p>This method produces new feature and target arrays whose dimensions are determined by the model’s posterior parameters, input dimensionality, and the sample size of the original data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Original feature matrix of shape <cite>(sample_size, input_dim)</cite>.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Original target values of shape <cite>(sample_size,)</cite> or <cite>(sample_size, n_targets)</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple containing the resampled feature matrix and target array.</p>
<ul class="simple">
<li><p>Resampled X has shape <cite>(posterior_param_num, sample_size, input_dim)</cite></p></li>
<li><p>Resampled y has shape <cite>(posterior_param_num, sample_size)</cite> (for single-target) or <cite>(posterior_param_num, sample_size, n_targets)</cite></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)">numpy.ndarray</a>]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If <cite>X</cite> and <cite>y</cite> have inconsistent sample sizes (first dimension mismatch).</p></li>
<li><p>If <cite>posterior_param_num</cite> is not initialized (e.g., model not yet fitted).</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># After fitting a BayesianDRO model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_new</span><span class="p">,</span> <span class="n">y_new</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X_new</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (n_params, 1000, 10) if sample_size=1000, input_dim=10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y_new</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (n_params, 1000)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.linear_model.bayesian_dro.BayesianDRO.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.linear_model.bayesian_dro.BayesianDRO.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the Bayesian DRO model by solving the convex optimization problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Feature matrix of shape <cite>(original_sample_size, input_dim)</cite>.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a>) – Target values of shape <cite>(original_sample_size,)</cite> for classification or <cite>(original_sample_size, n_targets)</cite> for regression.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing the trained parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">theta</span></code>: Weight vector of shape <cite>(input_dim,)</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code>: Intercept scalar (only if <cite>fit_intercept=True</cite>)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Union[List[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>], <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>BayesianDROError</strong> – If the optimization solver fails to converge.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul>
<li><p>If <cite>X</cite> and <cite>y</cite> have inconsistent sample sizes.</p></li>
<li><p>If resampled data dimensions are incompatible with <cite>posterior_param_num</cite>.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Optimization Formulation:</dt><dd><dl class="simple">
<dt>Minimize:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">(1/K)</span> <span class="pre">*</span> <span class="pre">Σ</span> <span class="pre">t_k</span> <span class="pre">+</span> <span class="pre">η</span> <span class="pre">*</span> <span class="pre">eps</span></code>  
where K = <cite>posterior_param_num</cite>, eps = <cite>self.eps</cite></p>
</dd>
</dl>
<p>Subject to:</p>
<blockquote>
<div><ul class="simple">
<li><p>Exponential cone constraints: <code class="docutils literal notranslate"><span class="pre">ExpCone(per_loss</span> <span class="pre">-</span> <span class="pre">t,</span> <span class="pre">η,</span> <span class="pre">epi_g)</span></code></p></li>
<li><p>Loss bounds: <code class="docutils literal notranslate"><span class="pre">per_loss</span> <span class="pre">≥</span> <span class="pre">model-specific</span> <span class="pre">loss</span> <span class="pre">(e.g.,</span> <span class="pre">SVM</span> <span class="pre">hinge</span> <span class="pre">loss)</span></code></p></li>
<li><p>Ambiguity set: <code class="docutils literal notranslate"><span class="pre">Σ</span> <span class="pre">epi_g</span> <span class="pre">≤</span> <span class="pre">sample_size</span></code></p></li>
</ul>
</div></blockquote>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">])</span>  <span class="c1"># e.g., [0.5, -1.2, ..., 0.8]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">])</span>      <span class="c1"># e.g., 0.3</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-dro.src.neural_model.base_nn">
<span id="neural-network-dro-methods"></span><h2>Neural Network DRO Methods<a class="headerlink" href="#module-dro.src.neural_model.base_nn" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dro.src.neural_model.base_nn.Linear">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.neural_model.base_nn.</span></span><span class="sig-name descname"><span class="pre">Linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.neural_model.base_nn.Linear" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Fully-connected neural layer for classification/regression.</p>
<p>Implements the linear transformation:</p>
<div class="math notranslate nohighlight">
\[Y = XW^\top + b\]</div>
<p>where:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(X \in \mathbb{R}^{N \times d}\)</span>: input features</p></li>
<li><p><span class="math notranslate nohighlight">\(W \in \mathbb{R}^{K \times d}\)</span>: weight matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(b \in \mathbb{R}^K\)</span>: bias term</p></li>
<li><p><span class="math notranslate nohighlight">\(Y \in \mathbb{R}^{N \times K}\)</span>: output logits</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimension of input features <span class="math notranslate nohighlight">\(d\)</span>. Must be ≥ 1.</p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of output classes <span class="math notranslate nohighlight">\(K\)</span>. 
Use 1 for binary classification.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Example::</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Linear</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># batch_size=32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([32, 3])</span>
</pre></div>
</div>
</dd>
</dl>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.neural_model.base_nn.Linear.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.neural_model.base_nn.Linear.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward pass of the linear layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><em>torch.Tensor</em></a>) – Input tensor of shape <span class="math notranslate nohighlight">\((N, d)\)</span>
where <span class="math notranslate nohighlight">\(N\)</span> = batch size</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output logits of shape <span class="math notranslate nohighlight">\((N, K)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dro.src.neural_model.base_nn.MLP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.neural_model.base_nn.</span></span><span class="sig-name descname"><span class="pre">MLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ReLU()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.neural_model.base_nn.MLP" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Multi-Layer Perceptron with dropout regularization.</p>
<p>Implements the forward computation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}h_1 &amp;= \sigma(W_1 x + b_1) \\
h_2 &amp;= \sigma(W_2 h_1 + b_2) \\
y &amp;= W_o h_2 + b_o\end{split}\]</div>
<dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\sigma\)</span>: activation function (default: ReLU)</p></li>
<li><p><span class="math notranslate nohighlight">\(p \in [0,1)\)</span>: dropout probability</p></li>
<li><p><span class="math notranslate nohighlight">\(x \in \mathbb{R}^d\)</span>: input features</p></li>
<li><p><span class="math notranslate nohighlight">\(y \in \mathbb{R}^K\)</span>: output logits</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Input feature dimension <span class="math notranslate nohighlight">\(d \geq 1\)</span></p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Output dimension <span class="math notranslate nohighlight">\(K \geq 1\)</span></p></li>
<li><p><strong>hidden_units</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Hidden layer dimension <span class="math notranslate nohighlight">\(h \geq 1\)</span>, 
defaults to 16</p></li>
<li><p><strong>activation</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.6)"><em>torch.nn.Module</em></a>) – Nonlinear activation module, 
defaults to <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.ReLU.html#torch.nn.ReLU" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.ReLU</span></code></a></p></li>
<li><p><strong>dropout_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Dropout probability <span class="math notranslate nohighlight">\(p \in [0,1)\)</span>, 
defaults to 0.1</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Example::</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MLP</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_dim</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hidden_units</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">activation</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">GELU</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">dropout_rate</span><span class="o">=</span><span class="mf">0.2</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>  <span class="c1"># batch_size=128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([128, 10])</span>
</pre></div>
</div>
</dd>
</dl>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.neural_model.base_nn.MLP.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.neural_model.base_nn.MLP.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward propagation with dropout regularization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><em>torch.Tensor</em></a>) – Input tensor of shape <span class="math notranslate nohighlight">\((N, d)\)</span>
where <span class="math notranslate nohighlight">\(N\)</span> = batch size</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output logits of shape <span class="math notranslate nohighlight">\((N, K)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dro.src.neural_model.base_nn.BaseNNDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.neural_model.base_nn.</span></span><span class="sig-name descname"><span class="pre">BaseNNDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'classification'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mlp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.neural_model.base_nn.BaseNNDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Neural Network-based Distributionally Robust Optimization (DRO) framework.</p>
<p>Implements the core DRO optimization objective:</p>
<div class="math notranslate nohighlight">
\[\min_{\theta} \sup_{Q \in \mathcal{B}_\epsilon(P)} \mathbb{E}_Q[\ell(f_\theta(X), y)]\]</div>
<p>where:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f_     heta\)</span>: Parametric neural network</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{B}_\epsilon(P)\)</span>: Wasserstein ambiguity set</p></li>
</ul>
</div></blockquote>
<p>Initialize neural DRO framework.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Input feature dimension <span class="math notranslate nohighlight">\(d \geq 1\)</span></p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Output dimension:
- Classification: <span class="math notranslate nohighlight">\(K \geq 2\)</span> (number of classes)
- Regression: Automatically set to 1</p></li>
<li><p><strong>task_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Learning task type. Supported:
- <code class="docutils literal notranslate"><span class="pre">'classification'</span></code>: Cross-entropy loss
- <code class="docutils literal notranslate"><span class="pre">'regression'</span></code>: MSE loss</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Neural architecture type. Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'mlp'</span></code>: Multi-Layer Perceptron (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">linear</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resnet</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alexnet</span></code></p></li>
</ul>
</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.6)"><em>torch.device</em></a>) – Target computation device, defaults to CPU</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If input_dim &lt; 1</p></li>
<li><p>If classification task with num_classes &lt; 2</p></li>
<li><p>If unsupported model_type</p></li>
</ul>
</p>
</dd>
</dl>
<p>Example (Classification):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BaseNNDRO</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_dim</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">task_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">model_type</span><span class="o">=</span><span class="s2">&quot;mlp&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>Example (Regression):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BaseNNDRO</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_dim</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">num_classes</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>  <span class="c1"># Auto-override to 1</span>
<span class="gp">... </span>    <span class="n">task_type</span><span class="o">=</span><span class="s2">&quot;regression&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.neural_model.base_nn.BaseNNDRO.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.neural_model.base_nn.BaseNNDRO.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Train neural DRO model with Wasserstein robust optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><em>torch.Tensor</em></a><em>]</em>) – <p>Input feature matrix/tensor. Shape:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\((N, d)\)</span> where <span class="math notranslate nohighlight">\(N\)</span> = total samples</p></li>
<li><p>Supports both numpy arrays and torch tensors</p></li>
</ul>
</p></li>
<li><p><strong>y</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><em>torch.Tensor</em></a><em>]</em>) – <p>Target labels. Shape:</p>
<ul>
<li><p>Classification: <span class="math notranslate nohighlight">\((N,)\)</span> (class indices). Note that y in {0,1} here.</p></li>
<li><p>Regression: <span class="math notranslate nohighlight">\((N,)\)</span> or <span class="math notranslate nohighlight">\((N, 1)\)</span></p></li>
</ul>
</p></li>
<li><p><strong>train_ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Train-validation split ratio <span class="math notranslate nohighlight">\(\in (0,1)\)</span>, 
defaults to 0.8</p></li>
<li><p><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Learning rate <span class="math notranslate nohighlight">\(\eta &gt; 0\)</span>, defaults to 1e-3</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Mini-batch size <span class="math notranslate nohighlight">\(B \geq 1\)</span>, 
defaults to 32</p></li>
<li><p><strong>epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Maximum training epochs <span class="math notranslate nohighlight">\(T \geq 1\)</span>, 
defaults to 100</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to print epoch-wise metrics, 
defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'acc,</span> <span class="pre">f1'</span></code>: for classification</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mse'</span></code>: for regression</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, List[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If input dimensions mismatch</p></li>
<li><p>If train_ratio ∉ (0,1)</p></li>
<li><p>If batch_size &gt; dataset size</p></li>
<li><p>If learning rate ≤ 0</p></li>
</ul>
</p>
</dd>
</dl>
<p>Example (Classification):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BaseNNDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">5e-4</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;val_accuracy&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Example (Regression):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BaseNNDRO</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">task_type</span><span class="o">=</span><span class="s1">&#39;regression&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.neural_model.base_nn.BaseNNDRO.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.neural_model.base_nn.BaseNNDRO.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Make predictions on input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>X</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><em>Tensor</em></a><em>]</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.neural_model.base_nn.BaseNNDRO.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.neural_model.base_nn.BaseNNDRO.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate classification accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><em>Tensor</em></a><em>]</em>) – </p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><em>Tensor</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.neural_model.base_nn.BaseNNDRO.f1score">
<span class="sig-name descname"><span class="pre">f1score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.neural_model.base_nn.BaseNNDRO.f1score" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate macro-averaged F1 score.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><em>Tensor</em></a><em>]</em>) – </p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><em>Tensor</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-dro.src.neural_model.fdro_nn"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.neural_model.fdro_nn.Chi2NNDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.neural_model.fdro_nn.</span></span><span class="sig-name descname"><span class="pre">Chi2NNDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'classification'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mlp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.neural_model.fdro_nn.Chi2NNDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.neural_model.base_nn.BaseNNDRO" title="dro.src.neural_model.base_nn.BaseNNDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseNNDRO</span></code></a></p>
<p>Chi-square Divergence-based Neural DRO Model.</p>
<p>Initialize Chi-square DRO neural model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Input feature dimension <span class="math notranslate nohighlight">\(d \geq 1\)</span></p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – <p>Output dimension:</p>
<ul>
<li><p>Classification: <span class="math notranslate nohighlight">\(K \geq 2\)</span> (number of classes)</p></li>
<li><p>Regression: Automatically set to 1</p></li>
</ul>
</p></li>
<li><p><strong>task_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Learning task type. Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'classification'</span></code>: Cross-entropy loss</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'regression'</span></code>: MSE loss</p></li>
</ul>
</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Neural architecture type. Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'mlp'</span></code>: Multi-Layer Perceptron (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">linear</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resnet</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alexnet</span></code></p></li>
</ul>
</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.6)"><em>torch.device</em></a>) – Target computation device, defaults to CPU</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Chi-square divergence radius <span class="math notranslate nohighlight">\(\rho \geq 0\)</span> controlling distributional robustness. Larger values increase conservativeness. Defaults to 0.1.</p></li>
<li><p><strong>reg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Regularization coefficient. Defaults to 0.1.</p></li>
<li><p><strong>max_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Maximum Sinkhorn iterations. Defaults to 100.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If size &lt; 0</p></li>
<li><p>If reg ≤ 0</p></li>
<li><p>If max_iter &lt; 1</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dro.src.neural_model.fdro_nn.CVaRNNDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.neural_model.fdro_nn.</span></span><span class="sig-name descname"><span class="pre">CVaRNNDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'classification'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mlp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.neural_model.fdro_nn.CVaRNNDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.neural_model.base_nn.BaseNNDRO" title="dro.src.neural_model.base_nn.BaseNNDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseNNDRO</span></code></a></p>
<p>Initialize Conditional Value-at-Risk DRO neural model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Input feature dimension <span class="math notranslate nohighlight">\(d \geq 1\)</span></p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – <p>Output dimension:</p>
<ul>
<li><p>Classification: <span class="math notranslate nohighlight">\(K \geq 2\)</span> (number of classes)</p></li>
<li><p>Regression: Automatically set to 1</p></li>
</ul>
</p></li>
<li><p><strong>task_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Learning task type. Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'classification'</span></code>: Cross-entropy loss</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'regression'</span></code>: MSE loss</p></li>
</ul>
</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Neural architecture type. Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'mlp'</span></code>: Multi-Layer Perceptron (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">linear</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resnet</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alexnet</span></code></p></li>
</ul>
</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.6)"><em>torch.device</em></a>) – Target computation device, defaults to CPU</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – CVaR ratio <span class="math notranslate nohighlight">\(1 \geq \rho \geq 0\)</span> controlling distributional robustness. Smaller values increase conservativeness. Defaults to 0.1.</p></li>
<li><p><strong>reg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Regularization coefficient. Defaults to 0.1.</p></li>
<li><p><strong>max_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Maximum Sinkhorn iterations. Defaults to 100.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If size &lt; 0</p></li>
<li><p>If reg ≤ 0</p></li>
<li><p>If max_iter &lt; 1</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-dro.src.neural_model.hrdro_nn"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.neural_model.hrdro_nn.HRNNDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.neural_model.hrdro_nn.</span></span><span class="sig-name descname"><span class="pre">HRNNDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'classification'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mlp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_approach</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HD'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adversarial_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.neural_model.hrdro_nn.HRNNDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.neural_model.base_nn.BaseNNDRO" title="dro.src.neural_model.base_nn.BaseNNDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseNNDRO</span></code></a></p>
<p>Holistic Robust DRO.</p>
<p>Initialize Holistic Robust DRO.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Input feature dimension <span class="math notranslate nohighlight">\(d \geq 1\)</span></p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – <p>Output dimension:</p>
<ul>
<li><p>Classification: <span class="math notranslate nohighlight">\(K \geq 2\)</span> (number of classes)</p></li>
<li><p>Regression: Automatically set to 1</p></li>
</ul>
</p></li>
<li><p><strong>task_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Learning task type. Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'classification'</span></code>: Cross-entropy loss</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'regression'</span></code>: MSE loss</p></li>
</ul>
</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Neural architecture type. Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'mlp'</span></code>: Multi-Layer Perceptron (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">linear</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resnet</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alexnet</span></code></p></li>
</ul>
</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.6)"><em>torch.device</em></a>) – Target computation device, defaults to CPU</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Robustness regularization coefficient <span class="math notranslate nohighlight">\(\alpha &gt; 0\)</span>,
controls model conservativeness. Defaults to 0.1.</p></li>
<li><p><strong>r</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Statistical error radius <span class="math notranslate nohighlight">\(r &gt; 0\)</span> for distribution shift,
defaults to 0.01.</p></li>
<li><p><strong>epsilon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Contamination ratio <span class="math notranslate nohighlight">\(\epsilon \in [0,1)\)</span>,
proportion of adversarial samples. Defaults to 0.1.</p></li>
<li><p><strong>learning_approach</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Robust optimization method. Options:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;HR&quot;</span></code>: Huberian Robust optimization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;HD&quot;</span></code>: Hybrid DRO (default)</p></li>
</ul>
</p></li>
<li><p><strong>adversarial_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Adversarial training configuration:
Defaults to <code class="docutils literal notranslate"><span class="pre">{&quot;steps&quot;:7,</span> <span class="pre">&quot;step_size&quot;:0.03,</span> <span class="pre">&quot;norm&quot;:&quot;l-inf&quot;,</span> <span class="pre">&quot;method&quot;:&quot;PGD&quot;}</span></code></p></li>
<li><p><strong>train_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Training batch size <span class="math notranslate nohighlight">\(B \geq 1\)</span>,
defaults to 64.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If alpha ≤ 0</p></li>
<li><p>If r ≤ 0</p></li>
<li><p>If ε ∉ [0,1)</p></li>
<li><p>If invalid learning_approach</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Example (CIFAR-10)::</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adv_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;steps&quot;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;norm&quot;</span><span class="p">:</span><span class="s2">&quot;l2&quot;</span><span class="p">,</span> <span class="s2">&quot;method&quot;</span><span class="p">:</span><span class="s2">&quot;PGD&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">HRNNDRO</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_dim</span><span class="o">=</span><span class="mi">3072</span><span class="p">,</span> 
<span class="gp">... </span>    <span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">adversarial_params</span><span class="o">=</span><span class="n">adv_params</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dro.src.neural_model.hrdro_nn.HRNNDRO.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.neural_model.hrdro_nn.HRNNDRO.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Enhanced training loop with adversarial training</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]]</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><em>Tensor</em></a><em>]</em>) – </p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><em>Tensor</em></a><em>]</em>) – </p></li>
<li><p><strong>train_ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – </p></li>
<li><p><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – </p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>) – </p></li>
<li><p><strong>epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – </p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dro.src.neural_model.hrdro_nn.HRNNDRO.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.neural_model.hrdro_nn.HRNNDRO.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Adversarial-robust prediction</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>X</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><em>ndarray</em></a><em>, </em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><em>Tensor</em></a><em>]</em>) – </p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-dro.src.neural_model.wdro_nn"></span><dl class="py class">
<dt class="sig sig-object py" id="dro.src.neural_model.wdro_nn.WNNDRO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dro.src.neural_model.wdro_nn.</span></span><span class="sig-name descname"><span class="pre">WNNDRO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'classification'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mlp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adversarial_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adversarial_step_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adversarial_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'l2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adversarial_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PGD'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dro.src.neural_model.wdro_nn.WNNDRO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dro.src.neural_model.base_nn.BaseNNDRO" title="dro.src.neural_model.base_nn.BaseNNDRO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseNNDRO</span></code></a></p>
<p>Wasserstein Neural DRO with Adversarial Robustness.</p>
<p>Initialize Wasserstein DRO model with adversarial training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Input feature dimension <span class="math notranslate nohighlight">\(d \geq 1\)</span></p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Output dimension:
- Classification: <span class="math notranslate nohighlight">\(K \geq 2\)</span> (number of classes)
- Regression: Automatically set to 1</p></li>
<li><p><strong>task_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Learning task type. Supported:
- <code class="docutils literal notranslate"><span class="pre">'classification'</span></code>: Cross-entropy loss
- <code class="docutils literal notranslate"><span class="pre">'regression'</span></code>: MSE loss</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Neural architecture type. Supported:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'mlp'</span></code>: Multi-Layer Perceptron (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">linear</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resnet</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alexnet</span></code></p></li>
</ul>
</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.6)"><em>torch.device</em></a>) – Target computation device, defaults to CPU</p></li>
<li><p><strong>epsilon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Wasserstein radius <span class="math notranslate nohighlight">\(\epsilon \geq 0\)</span> controlling distributional robustness.
Larger values increase model conservativeness. Defaults to 0.1.</p></li>
<li><p><strong>adversarial_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of PGD attack iterations <span class="math notranslate nohighlight">\(T_{adv} \geq 1\)</span>.
Defaults to 10.</p></li>
<li><p><strong>adversarial_step_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – PGD step size <span class="math notranslate nohighlight">\(\eta_{adv} &gt; 0\)</span>.
Defaults to 0.02.</p></li>
<li><p><strong>adversarial_norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Adversarial perturbation norm type. Options:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'l2'</span></code>: <span class="math notranslate nohighlight">\(\ell_2\)</span>-ball constraint</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'l-inf'</span></code>: <span class="math notranslate nohighlight">\(\ell_\infty\)</span>-ball constraint</p></li>
</ul>
</p></li>
<li><p><strong>adversarial_method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Adversarial example generation method. Options:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'PGD'</span></code>: Projected Gradient Descent (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'FGSM'</span></code>: Fast Gradient Sign Method</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If epsilon &lt; 0</p></li>
<li><p>If adversarial_steps &lt; 1</p></li>
<li><p>If adversarial_step_size ≤ 0</p></li>
<li><p>If invalid norm/method type</p></li>
</ul>
</p>
</dd>
</dl>
<dl>
<dt>Example (MNIST)::</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">WNNDRO</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_dim</span><span class="o">=</span><span class="mi">784</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">adversarial_norm</span><span class="o">=</span><span class="s2">&quot;l-inf&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">adversarial_steps</span><span class="o">=</span><span class="mi">7</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
    
        <div id="show_right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&lt;</span><span>Page contents</span></a></p>
        </div>

        <div id="right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&gt;</span><span>Page contents:</span></a></p>
            <div class="page_toc">
                <ul>
<li><a class="reference internal" href="#">API</a><ul>
<li><a class="reference internal" href="#module-dro.src.data.dataloader_classification">Data Modules</a><ul>
<li><a class="reference internal" href="#dro.src.data.dataloader_classification.classification_basic"><code class="docutils literal notranslate"><span class="pre">classification_basic()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.data.dataloader_classification.classification_DN21"><code class="docutils literal notranslate"><span class="pre">classification_DN21()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.data.dataloader_classification.classification_SNVD20"><code class="docutils literal notranslate"><span class="pre">classification_SNVD20()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.data.dataloader_classification.classification_LWLC"><code class="docutils literal notranslate"><span class="pre">classification_LWLC()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.data.dataloader_regression.regression_basic"><code class="docutils literal notranslate"><span class="pre">regression_basic()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.data.dataloader_regression.regression_DN20_1"><code class="docutils literal notranslate"><span class="pre">regression_DN20_1()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.data.dataloader_regression.regression_DN20_2"><code class="docutils literal notranslate"><span class="pre">regression_DN20_2()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.data.dataloader_regression.regression_DN20_3"><code class="docutils literal notranslate"><span class="pre">regression_DN20_3()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.data.dataloader_regression.regression_LWLC"><code class="docutils literal notranslate"><span class="pre">regression_LWLC()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-dro.src.linear_model.base">Linear DRO Methods</a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO"><code class="docutils literal notranslate"><span class="pre">BaseLinearDRO</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO.update"><code class="docutils literal notranslate"><span class="pre">BaseLinearDRO.update()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO.fit"><code class="docutils literal notranslate"><span class="pre">BaseLinearDRO.fit()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO.load"><code class="docutils literal notranslate"><span class="pre">BaseLinearDRO.load()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO.predict"><code class="docutils literal notranslate"><span class="pre">BaseLinearDRO.predict()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO.score"><code class="docutils literal notranslate"><span class="pre">BaseLinearDRO.score()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.base.BaseLinearDRO.evaluate"><code class="docutils literal notranslate"><span class="pre">BaseLinearDRO.evaluate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.linear_model.chi2_dro.Chi2DRO"><code class="docutils literal notranslate"><span class="pre">Chi2DRO</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.chi2_dro.Chi2DRO.update"><code class="docutils literal notranslate"><span class="pre">Chi2DRO.update()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.chi2_dro.Chi2DRO.fit"><code class="docutils literal notranslate"><span class="pre">Chi2DRO.fit()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.chi2_dro.Chi2DRO.evaluate"><code class="docutils literal notranslate"><span class="pre">Chi2DRO.evaluate()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.chi2_dro.Chi2DRO.worst_distribution"><code class="docutils literal notranslate"><span class="pre">Chi2DRO.worst_distribution()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.linear_model.cvar_dro.CVaRDRO"><code class="docutils literal notranslate"><span class="pre">CVaRDRO</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.cvar_dro.CVaRDRO.update"><code class="docutils literal notranslate"><span class="pre">CVaRDRO.update()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.cvar_dro.CVaRDRO.fit"><code class="docutils literal notranslate"><span class="pre">CVaRDRO.fit()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.cvar_dro.CVaRDRO.worst_distribution"><code class="docutils literal notranslate"><span class="pre">CVaRDRO.worst_distribution()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.linear_model.kl_dro.KLDRO"><code class="docutils literal notranslate"><span class="pre">KLDRO</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.kl_dro.KLDRO.update"><code class="docutils literal notranslate"><span class="pre">KLDRO.update()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.kl_dro.KLDRO.fit"><code class="docutils literal notranslate"><span class="pre">KLDRO.fit()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.kl_dro.KLDRO.worst_distribution"><code class="docutils literal notranslate"><span class="pre">KLDRO.worst_distribution()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.linear_model.tv_dro.TVDRO"><code class="docutils literal notranslate"><span class="pre">TVDRO</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.tv_dro.TVDRO.threshold_val"><code class="docutils literal notranslate"><span class="pre">TVDRO.threshold_val</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.tv_dro.TVDRO.update"><code class="docutils literal notranslate"><span class="pre">TVDRO.update()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.tv_dro.TVDRO.fit"><code class="docutils literal notranslate"><span class="pre">TVDRO.fit()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.tv_dro.TVDRO.worst_distribution"><code class="docutils literal notranslate"><span class="pre">TVDRO.worst_distribution()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.linear_model.conditional_dro.ConditionalCVaRDRO"><code class="docutils literal notranslate"><span class="pre">ConditionalCVaRDRO</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.conditional_dro.ConditionalCVaRDRO.update"><code class="docutils literal notranslate"><span class="pre">ConditionalCVaRDRO.update()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.conditional_dro.ConditionalCVaRDRO.fit"><code class="docutils literal notranslate"><span class="pre">ConditionalCVaRDRO.fit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.linear_model.hr_dro.HR_DRO_LR"><code class="docutils literal notranslate"><span class="pre">HR_DRO_LR</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.hr_dro.HR_DRO_LR.update"><code class="docutils literal notranslate"><span class="pre">HR_DRO_LR.update()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.hr_dro.HR_DRO_LR.fit"><code class="docutils literal notranslate"><span class="pre">HR_DRO_LR.fit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.linear_model.marginal_dro.MarginalCVaRDRO"><code class="docutils literal notranslate"><span class="pre">MarginalCVaRDRO</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.marginal_dro.MarginalCVaRDRO.update"><code class="docutils literal notranslate"><span class="pre">MarginalCVaRDRO.update()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.marginal_dro.MarginalCVaRDRO.fit"><code class="docutils literal notranslate"><span class="pre">MarginalCVaRDRO.fit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.linear_model.mmd_dro.MMD_DRO"><code class="docutils literal notranslate"><span class="pre">MMD_DRO</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.mmd_dro.MMD_DRO.update"><code class="docutils literal notranslate"><span class="pre">MMD_DRO.update()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.mmd_dro.MMD_DRO.fit"><code class="docutils literal notranslate"><span class="pre">MMD_DRO.fit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.linear_model.mot_dro.MOTDRO"><code class="docutils literal notranslate"><span class="pre">MOTDRO</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.mot_dro.MOTDRO.update"><code class="docutils literal notranslate"><span class="pre">MOTDRO.update()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.mot_dro.MOTDRO.fit"><code class="docutils literal notranslate"><span class="pre">MOTDRO.fit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.linear_model.or_wasserstein_dro.ORWDRO"><code class="docutils literal notranslate"><span class="pre">ORWDRO</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.or_wasserstein_dro.ORWDRO.update"><code class="docutils literal notranslate"><span class="pre">ORWDRO.update()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.or_wasserstein_dro.ORWDRO.fit"><code class="docutils literal notranslate"><span class="pre">ORWDRO.fit()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.or_wasserstein_dro.ORWDRO.worst_distribution"><code class="docutils literal notranslate"><span class="pre">ORWDRO.worst_distribution()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.linear_model.sinkhorn_dro.SinkhornLinearDRO"><code class="docutils literal notranslate"><span class="pre">SinkhornLinearDRO</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.sinkhorn_dro.SinkhornLinearDRO.update"><code class="docutils literal notranslate"><span class="pre">SinkhornLinearDRO.update()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.sinkhorn_dro.SinkhornLinearDRO.predict"><code class="docutils literal notranslate"><span class="pre">SinkhornLinearDRO.predict()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.sinkhorn_dro.SinkhornLinearDRO.score"><code class="docutils literal notranslate"><span class="pre">SinkhornLinearDRO.score()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.sinkhorn_dro.SinkhornLinearDRO.fit"><code class="docutils literal notranslate"><span class="pre">SinkhornLinearDRO.fit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.linear_model.wasserstein_dro.WassersteinDRO"><code class="docutils literal notranslate"><span class="pre">WassersteinDRO</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.wasserstein_dro.WassersteinDRO.update"><code class="docutils literal notranslate"><span class="pre">WassersteinDRO.update()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.wasserstein_dro.WassersteinDRO.fit"><code class="docutils literal notranslate"><span class="pre">WassersteinDRO.fit()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.wasserstein_dro.WassersteinDRO.worst_distribution"><code class="docutils literal notranslate"><span class="pre">WassersteinDRO.worst_distribution()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing"><code class="docutils literal notranslate"><span class="pre">WassersteinDROsatisficing</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing.update"><code class="docutils literal notranslate"><span class="pre">WassersteinDROsatisficing.update()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing.fit"><code class="docutils literal notranslate"><span class="pre">WassersteinDROsatisficing.fit()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing.fit_depreciate"><code class="docutils literal notranslate"><span class="pre">WassersteinDROsatisficing.fit_depreciate()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing.fit_oracle"><code class="docutils literal notranslate"><span class="pre">WassersteinDROsatisficing.fit_oracle()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.wasserstein_dro.WassersteinDROsatisficing.worst_distribution"><code class="docutils literal notranslate"><span class="pre">WassersteinDROsatisficing.worst_distribution()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.linear_model.bayesian_dro.BayesianDRO"><code class="docutils literal notranslate"><span class="pre">BayesianDRO</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.linear_model.bayesian_dro.BayesianDRO.update"><code class="docutils literal notranslate"><span class="pre">BayesianDRO.update()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.bayesian_dro.BayesianDRO.resample"><code class="docutils literal notranslate"><span class="pre">BayesianDRO.resample()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.linear_model.bayesian_dro.BayesianDRO.fit"><code class="docutils literal notranslate"><span class="pre">BayesianDRO.fit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-dro.src.neural_model.base_nn">Neural Network DRO Methods</a><ul>
<li><a class="reference internal" href="#dro.src.neural_model.base_nn.Linear"><code class="docutils literal notranslate"><span class="pre">Linear</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.neural_model.base_nn.Linear.forward"><code class="docutils literal notranslate"><span class="pre">Linear.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.neural_model.base_nn.MLP"><code class="docutils literal notranslate"><span class="pre">MLP</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.neural_model.base_nn.MLP.forward"><code class="docutils literal notranslate"><span class="pre">MLP.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.neural_model.base_nn.BaseNNDRO"><code class="docutils literal notranslate"><span class="pre">BaseNNDRO</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.neural_model.base_nn.BaseNNDRO.fit"><code class="docutils literal notranslate"><span class="pre">BaseNNDRO.fit()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.neural_model.base_nn.BaseNNDRO.predict"><code class="docutils literal notranslate"><span class="pre">BaseNNDRO.predict()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.neural_model.base_nn.BaseNNDRO.score"><code class="docutils literal notranslate"><span class="pre">BaseNNDRO.score()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.neural_model.base_nn.BaseNNDRO.f1score"><code class="docutils literal notranslate"><span class="pre">BaseNNDRO.f1score()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.neural_model.fdro_nn.Chi2NNDRO"><code class="docutils literal notranslate"><span class="pre">Chi2NNDRO</span></code></a></li>
<li><a class="reference internal" href="#dro.src.neural_model.fdro_nn.CVaRNNDRO"><code class="docutils literal notranslate"><span class="pre">CVaRNNDRO</span></code></a></li>
<li><a class="reference internal" href="#dro.src.neural_model.hrdro_nn.HRNNDRO"><code class="docutils literal notranslate"><span class="pre">HRNNDRO</span></code></a><ul>
<li><a class="reference internal" href="#dro.src.neural_model.hrdro_nn.HRNNDRO.fit"><code class="docutils literal notranslate"><span class="pre">HRNNDRO.fit()</span></code></a></li>
<li><a class="reference internal" href="#dro.src.neural_model.hrdro_nn.HRNNDRO.predict"><code class="docutils literal notranslate"><span class="pre">HRNNDRO.predict()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dro.src.neural_model.wdro_nn.WNNDRO"><code class="docutils literal notranslate"><span class="pre">WNNDRO</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
        </div>
    

      <div class="clearer"></div>
    </div>
    <div class="button_nav_wrapper">
        <div class="button_nav">
            <div class="left">
                
                <a href="../tutorials/personal_loss.html">
                    <span class="icon">&lt;</span><span>Personal Loss</span></a>
                
            </div>

            <div class="right">
                
            </div>
        </div>
    </div>


    <div class="footer" role="contentinfo">
        &#169; Copyright 2025, Jiashuo Liu, Tianyu Wang.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>

<p id="theme_credit">Styled using the <a href="https://github.com/piccolo-orm/piccolo_theme">Piccolo Theme</a></p>
  </body>
</html>